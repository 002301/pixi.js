/**
 * @license
 * Pixi.JS - v1.0.0
 * Copyright (c) 2012, Mat Groves
 * http://goodboydigital.com/
 *
 * Compiled: 2013-06-20
 *
 * Pixi.JS is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license.php
 */
(function(){function t(){return o.Matrix="undefined"!=typeof Float32Array?Float32Array:Array,o.Matrix}function e(t){return[(255&t>>16)/255,(255&t>>8)/255,(255&t)/255]}function e(t){return[(255&t>>16)/255,(255&t>>8)/255,(255&t)/255]}function i(t,e){return new o.Point(-(t.y-e.y),t.x-e.x)}function n(t,e,i,r){var n,s,a,h,l,u,c;s=e.y-t.y,h=t.x-e.x,u=e.x*t.y-t.x*e.y,a=r.y-i.y,l=i.x-r.x,c=r.x*i.y-i.x*r.y;var d=s*l-a*h;return 0==d&&(console.log("!"),d+=1),n=new o.Point,n.x=(h*c-l*u)/d,n.y=(a*u-s*c)/d,n}var s=this,o=o||{};o.Point=function(t,e){this.x=t||0,this.y=e||0},o.Point.prototype.clone=function(){return new o.Point(this.x,this.y)},o.Point.constructor=o.Point,o.Rectangle=function(t,e,i,r){this.x=t||0,this.y=e||0,this.width=i||0,this.height=r||0},o.Rectangle.prototype.clone=function(){return new o.Rectangle(this.x,this.y,this.width,this.height)},o.Rectangle.constructor=o.Rectangle,o.Polygon=function(t){this.points=t},o.Polygon.clone=function(){for(var t=[],e=0;this.points.length>e;e++)t.push(this.points[e].clone());return new o.Polygon(t)},o.Polygon.constructor=o.Polygon,t(),o.mat3={},o.mat3.create=function(){var t=new o.Matrix(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},o.mat4={},o.mat4.create=function(){var t=new o.Matrix(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},o.mat3.multiply=function(t,e,i){i||(i=t);var r=t[0],n=t[1],s=t[2],a=t[3],o=t[4],h=t[5],l=t[6],u=t[7],c=t[8],d=e[0],p=e[1],f=e[2],v=e[3],m=e[4],g=e[5],x=e[6],b=e[7],y=e[8];return i[0]=d*r+p*a+f*l,i[1]=d*n+p*o+f*u,i[2]=d*s+p*h+f*c,i[3]=v*r+m*a+g*l,i[4]=v*n+m*o+g*u,i[5]=v*s+m*h+g*c,i[6]=x*r+b*a+y*l,i[7]=x*n+b*o+y*u,i[8]=x*s+b*h+y*c,i},o.mat3.toMat4=function(t,e){return e||(e=o.mat4.create()),e[15]=1,e[14]=0,e[13]=0,e[12]=0,e[11]=0,e[10]=t[8],e[9]=t[7],e[8]=t[6],e[7]=0,e[6]=t[5],e[5]=t[4],e[4]=t[3],e[3]=0,e[2]=t[2],e[1]=t[1],e[0]=t[0],e},o.mat4.create=function(){var t=new o.Matrix(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},o.mat4.transpose=function(t,e){if(!e||t===e){var i=t[1],r=t[2],n=t[3],s=t[6],a=t[7],o=t[11];return t[1]=t[4],t[2]=t[8],t[3]=t[12],t[4]=i,t[6]=t[9],t[7]=t[13],t[8]=r,t[9]=s,t[11]=t[14],t[12]=n,t[13]=a,t[14]=o,t}return e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15],e},o.mat4.multiply=function(t,e,i){i||(i=t);var r=t[0],n=t[1],s=t[2],a=t[3],o=t[4],h=t[5],l=t[6],u=t[7],c=t[8],d=t[9],p=t[10],f=t[11],v=t[12],m=t[13],g=t[14],x=t[15],b=e[0],y=e[1],T=e[2],w=e[3];return i[0]=b*r+y*o+T*c+w*v,i[1]=b*n+y*h+T*d+w*m,i[2]=b*s+y*l+T*p+w*g,i[3]=b*a+y*u+T*f+w*x,b=e[4],y=e[5],T=e[6],w=e[7],i[4]=b*r+y*o+T*c+w*v,i[5]=b*n+y*h+T*d+w*m,i[6]=b*s+y*l+T*p+w*g,i[7]=b*a+y*u+T*f+w*x,b=e[8],y=e[9],T=e[10],w=e[11],i[8]=b*r+y*o+T*c+w*v,i[9]=b*n+y*h+T*d+w*m,i[10]=b*s+y*l+T*p+w*g,i[11]=b*a+y*u+T*f+w*x,b=e[12],y=e[13],T=e[14],w=e[15],i[12]=b*r+y*o+T*c+w*v,i[13]=b*n+y*h+T*d+w*m,i[14]=b*s+y*l+T*p+w*g,i[15]=b*a+y*u+T*f+w*x,i},o.DisplayObject=function(){this.position=new o.Point,this.scale=new o.Point(1,1),this.pivot=new o.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.worldVisible=!1,this.parent=null,this.stage=null,this.hitArea=null,this.worldAlpha=1,this.color=[],this.worldTransform=o.mat3.create(),this.localTransform=o.mat3.create(),this.dynamic=!0,this._sr=0,this._cr=1,this.childIndex=0,this.renderable=!1,this.interactive=!1,this.buttonMode=!1},o.DisplayObject.constructor=o.DisplayObject,o.DisplayObject.prototype.setInteractive=function(t){this.interactive=t,this.stage&&(this.stage.dirty=!0)},o.DisplayObject.prototype.updateTransform=function(){this.rotation!=this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation));var t=this.localTransform,e=this.parent.worldTransform,i=this.worldTransform;t[0]=this._cr*this.scale.x,t[1]=-this._sr*this.scale.y,t[3]=this._sr*this.scale.x,t[4]=this._cr*this.scale.y;var r=this.pivot.x,n=this.pivot.y;t[2]=this.position.x-t[0]*r-n*t[1],t[5]=this.position.y-t[4]*n-r*t[3];var s=t[0],a=t[1],o=t[2],h=t[3],l=t[4],u=t[5],c=e[0],d=e[1],p=e[2],f=e[3],v=e[4],m=e[5];i[0]=c*s+d*h,i[1]=c*a+d*l,i[2]=c*o+d*u+p,i[3]=f*s+v*h,i[4]=f*a+v*l,i[5]=f*o+v*u+m,this.worldAlpha=this.alpha*this.parent.worldAlpha},o.DisplayObjectContainer=function(){o.DisplayObject.call(this),this.children=[],this.renderable=!1},o.DisplayObjectContainer.constructor=o.DisplayObjectContainer,o.DisplayObjectContainer.prototype=Object.create(o.DisplayObject.prototype),o.DisplayObjectContainer.prototype.addChild=function(t){void 0!=t.parent&&t.parent.removeChild(t),t.parent=this,t.childIndex=this.children.length,this.children.push(t),this.stage&&this.stage.__addChild(t),this.__renderGroup&&(t.__renderGroup&&t.__renderGroup.removeDisplayObjectAndChildren(t),this.__renderGroup.addDisplayObjectAndChildren(t))},o.DisplayObjectContainer.prototype.addChildAt=function(t,e){if(!(e>=0&&this.children.length>=e))throw Error(t+" The index "+e+" supplied is out of bounds "+this.children.length);void 0!=t.parent&&t.parent.removeChild(t),e==this.children.length?this.children.push(t):this.children.splice(e,0,t),t.parent=this,t.childIndex=e;for(var i=this.children.length,r=e;i>r;r++)this.children[r].childIndex=r;this.stage&&this.stage.__addChild(t),this.__renderGroup&&(t.__renderGroup&&t.__renderGroup.removeDisplayObjectAndChildren(t),this.__renderGroup.addDisplayObjectAndChildren(t))},o.DisplayObjectContainer.prototype.swapChildren=function(t,e){var i=this.children.indexOf(t),r=this.children.indexOf(e);if(-1===i||-1===r)throw Error(t+" Both the supplied DisplayObjects must be a child of the caller "+this);this.stage&&(this.stage.__removeChild(t),this.stage.__removeChild(e),this.stage.__addChild(t),this.stage.__addChild(e)),t.childIndex=r,e.childIndex=i,this.children[i]=e,this.children[r]=t},o.DisplayObjectContainer.prototype.getChildAt=function(t){if(t>=0&&this.children.length>t)return this.children[t];throw Error(child+" Both the supplied DisplayObjects must be a child of the caller "+this)},o.DisplayObjectContainer.prototype.removeChild=function(t){var e=this.children.indexOf(t);if(-1===e)throw Error(t+" The supplied DisplayObject must be a child of the caller "+this);this.stage&&this.stage.__removeChild(t),t.__renderGroup&&t.__renderGroup.removeDisplayObjectAndChildren(t),t.parent=void 0,this.children.splice(e,1);for(var i=e,r=this.children.length;r>i;i++)this.children[i].childIndex-=1},o.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible){o.DisplayObject.prototype.updateTransform.call(this);for(var t=0,e=this.children.length;e>t;t++)this.children[t].updateTransform()}},o.blendModes={},o.blendModes.NORMAL=0,o.blendModes.SCREEN=1,o.Sprite=function(t){o.DisplayObjectContainer.call(this),this.anchor=new o.Point,this.texture=t,this.blendMode=o.blendModes.NORMAL,this._width=0,this._height=0,t.baseTexture.hasLoaded?this.updateFrame=!0:(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind)),this.renderable=!0},o.Sprite.constructor=o.Sprite,o.Sprite.prototype=Object.create(o.DisplayObjectContainer.prototype),Object.defineProperty(o.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(t){this.scale.x=t/this.texture.frame.width,this._width=t}}),Object.defineProperty(o.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(t){this.scale.y=t/this.texture.frame.height,this._height=t}}),o.Sprite.prototype.setTexture=function(t){this.texture.baseTexture!=t.baseTexture&&(this.textureChange=!0),this.texture=t,this.updateFrame=!0},o.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width),this._height&&(this.scale.y=this._height/this.texture.frame.height),this.updateFrame=!0},o.Sprite.fromFrame=function(t){var e=o.TextureCache[t];if(!e)throw Error("The frameId '"+t+"' does not exist in the texture cache"+this);return new o.Sprite(e)},o.Sprite.fromImage=function(t){var e=o.Texture.fromImage(t);return new o.Sprite(e)},o.MovieClip=function(t){o.Sprite.call(this,t[0]),this.textures=t,this.currentFrame=0,this.animationSpeed=1,this.loop=!0,this.onComplete=null,this.playing},o.MovieClip.constructor=o.MovieClip,o.MovieClip.prototype=Object.create(o.Sprite.prototype),o.MovieClip.prototype.stop=function(){this.playing=!1},o.MovieClip.prototype.play=function(){this.playing=!0},o.MovieClip.prototype.gotoAndStop=function(t){this.playing=!1,this.currentFrame=t;var e=0|this.currentFrame+.5;this.setTexture(this.textures[e%this.textures.length])},o.MovieClip.prototype.gotoAndPlay=function(t){this.currentFrame=t,this.playing=!0},o.MovieClip.prototype.updateTransform=function(){if(o.Sprite.prototype.updateTransform.call(this),this.playing){this.currentFrame+=this.animationSpeed;var t=0|this.currentFrame+.5;this.loop||this.textures.length>t?this.setTexture(this.textures[t%this.textures.length]):t>=this.textures.length&&(this.gotoAndStop(this.textures.length-1),this.onComplete&&this.onComplete())}},o.Text=function(t,e){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),o.Sprite.call(this,o.Texture.fromCanvas(this.canvas)),this.setText(t),this.setStyle(e),this.updateText(),this.dirty=!1},o.Text.constructor=o.Text,o.Text.prototype=Object.create(o.Sprite.prototype),o.Text.prototype.setStyle=function(t){t=t||{},t.font=t.font||"bold 20pt Arial",t.fill=t.fill||"black",t.align=t.align||"left",t.stroke=t.stroke||"black",t.strokeThickness=t.strokeThickness||0,t.wordWrap=t.wordWrap||!1,t.wordWrapWidth=t.wordWrapWidth||100,this.style=t,this.dirty=!0},o.Sprite.prototype.setText=function(t){this.text=""+t||" ",this.dirty=!0},o.Text.prototype.updateText=function(){this.context.font=this.style.font;var t=this.text;this.style.wordWrap&&(t=this.wordWrap(this.text));for(var e=t.split(/(?:\r\n|\r|\n)/),i=[],r=0,n=0;e.length>n;n++){var s=this.context.measureText(e[n]).width;i[n]=s,r=Math.max(r,s)}this.canvas.width=r+this.style.strokeThickness;var a=this.determineFontHeight("font: "+this.style.font+";")+this.style.strokeThickness;for(this.canvas.height=a*e.length,this.context.fillStyle=this.style.fill,this.context.font=this.style.font,this.context.strokeStyle=this.style.stroke,this.context.lineWidth=this.style.strokeThickness,this.context.textBaseline="top",n=0;e.length>n;n++){var h=new o.Point(this.style.strokeThickness/2,this.style.strokeThickness/2+n*a);"right"==this.style.align?h.x+=r-i[n]:"center"==this.style.align&&(h.x+=(r-i[n])/2),this.style.stroke&&this.style.strokeThickness&&this.context.strokeText(e[n],h.x,h.y),this.style.fill&&this.context.fillText(e[n],h.x,h.y)}this.updateTexture()},o.Text.prototype.updateTexture=function(){this.texture.baseTexture.width=this.canvas.width,this.texture.baseTexture.height=this.canvas.height,this.texture.frame.width=this.canvas.width,this.texture.frame.height=this.canvas.height,this._width=this.canvas.width,this._height=this.canvas.height,o.texturesToUpdate.push(this.texture.baseTexture)},o.Text.prototype.updateTransform=function(){this.dirty&&(this.updateText(),this.dirty=!1),o.Sprite.prototype.updateTransform.call(this)},o.Text.prototype.determineFontHeight=function(t){var e=o.Text.heightCache[t];if(!e){var i=document.getElementsByTagName("body")[0],r=document.createElement("div"),n=document.createTextNode("M");r.appendChild(n),r.setAttribute("style",t+";position:absolute;top:0;left:0"),i.appendChild(r),e=r.offsetHeight,o.Text.heightCache[t]=e,i.removeChild(r)}return e},o.Text.prototype.wordWrap=function(t){for(var e=function(t,e,i,r,n){var s=Math.floor((r-i)/2)+i;return s==i?1:n>=t.measureText(e.substring(0,s)).width?t.measureText(e.substring(0,s+1)).width>n?s:arguments.callee(t,e,s,r,n):arguments.callee(t,e,i,s,n)},i=function(t,i,r){if(r>=t.measureText(i).width||1>i.length)return i;var n=e(t,i,0,i.length,r);return i.substring(0,n)+"\n"+arguments.callee(t,i.substring(n),r)},r="",n=t.split("\n"),s=0;n.length>s;s++)r+=i(this.context,n[s],this.style.wordWrapWidth)+"\n";return r},o.Text.prototype.destroy=function(t){t&&this.texture.destroy()},o.Text.heightCache={},o.BitmapText=function(t,e){o.DisplayObjectContainer.call(this),this.setText(t),this.setStyle(e),this.updateText(),this.dirty=!1},o.BitmapText.constructor=o.BitmapText,o.BitmapText.prototype=Object.create(o.DisplayObjectContainer.prototype),o.BitmapText.prototype.setText=function(t){this.text=t||" ",this.dirty=!0},o.BitmapText.prototype.setStyle=function(t){t=t||{},t.align=t.align||"left",this.style=t;var e=t.font.split(" ");this.fontName=e[e.length-1],this.fontSize=e.length>=2?parseInt(e[e.length-2],10):o.BitmapText.fonts[this.fontName].size,this.dirty=!0},o.BitmapText.prototype.updateText=function(){for(var t=o.BitmapText.fonts[this.fontName],e=new o.Point,i=null,r=[],n=0,s=[],a=0,h=this.fontSize/t.size,l=0;this.text.length>l;l++){var u=this.text.charCodeAt(l);if(/(?:\r\n|\r|\n)/.test(this.text.charAt(l)))s.push(e.x),n=Math.max(n,e.x),a++,e.x=0,e.y+=t.lineHeight,i=null;else{var c=t.chars[u];c&&(i&&c[i]&&(e.x+=c.kerning[i]),r.push({texture:c.texture,line:a,charCode:u,position:new o.Point(e.x+c.xOffset,e.y+c.yOffset)}),e.x+=c.xAdvance,i=u)}}s.push(e.x),n=Math.max(n,e.x);var d=[];for(l=0;a>=l;l++){var p=0;"right"==this.style.align?p=n-s[l]:"center"==this.style.align&&(p=(n-s[l])/2),d.push(p)}for(l=0;r.length>l;l++){var f=new o.Sprite(r[l].texture);f.position.x=(r[l].position.x+d[r[l].line])*h,f.position.y=r[l].position.y*h,f.scale.x=f.scale.y=h,this.addChild(f)}this.width=e.x*h,this.height=(e.y+t.lineHeight)*h},o.BitmapText.prototype.updateTransform=function(){if(this.dirty){for(;this.children.length>0;)this.removeChild(this.getChildAt(0));this.updateText(),this.dirty=!1}o.DisplayObjectContainer.prototype.updateTransform.call(this)},o.BitmapText.fonts={},o.InteractionManager=function(t){this.stage=t,this.tempPoint=new o.Point,this.mouseoverEnabled=!0,this.mouse=new o.InteractionData,this.touchs={},this.pool=[],this.interactiveItems=[],this.last=0},o.InteractionManager.constructor=o.InteractionManager,o.InteractionManager.prototype.collectInteractiveSprite=function(t,e){for(var i=t.children,r=i.length,n=r-1;n>=0;n--){var s=i[n];s.visible&&(s.interactive?(e.interactiveChildren=!0,this.interactiveItems.push(s),s.children.length>0&&this.collectInteractiveSprite(s,s)):(s.__iParent=null,s.children.length>0&&this.collectInteractiveSprite(s,e)))}},o.InteractionManager.prototype.setTarget=function(t){window.navigator.msPointerEnabled&&(t.view.style["-ms-content-zooming"]="none",t.view.style["-ms-touch-action"]="none"),this.target=t,t.view.addEventListener("mousemove",this.onMouseMove.bind(this),!0),t.view.addEventListener("mousedown",this.onMouseDown.bind(this),!0),document.body.addEventListener("mouseup",this.onMouseUp.bind(this),!0),t.view.addEventListener("mouseout",this.onMouseUp.bind(this),!0),t.view.addEventListener("touchstart",this.onTouchStart.bind(this),!0),t.view.addEventListener("touchend",this.onTouchEnd.bind(this),!0),t.view.addEventListener("touchmove",this.onTouchMove.bind(this),!0)},o.InteractionManager.prototype.update=function(){if(this.target){var t=Date.now(),e=t-this.last;if(e=30*e/1e3,!(1>e)){if(this.last=t,this.dirty){this.dirty=!1;for(var i=this.interactiveItems.length,r=0;i>r;r++)this.interactiveItems[r].interactiveChildren=!1;this.interactiveItems=[],this.stage.interactive&&this.interactiveItems.push(this.stage),this.collectInteractiveSprite(this.stage,this.stage)}var n=this.interactiveItems.length;this.target.view.style.cursor="default";for(var r=0;n>r;r++){var s=this.interactiveItems[r];s.visible&&(s.mouseover||s.mouseout||s.buttonMode)&&(s.__hit=this.hitTest(s,this.mouse),s.__hit?(s.buttonMode&&(this.target.view.style.cursor="pointer"),s.__isOver||(s.mouseover&&s.mouseover(this.mouse),s.__isOver=!0)):s.__isOver&&(s.mouseout&&s.mouseout(this.mouse),s.__isOver=!1))}}}},o.InteractionManager.prototype.onMouseMove=function(t){var e=this.target.view.getBoundingClientRect();this.mouse.global.x=(t.clientX-e.left)*(this.target.width/e.width),this.mouse.global.y=(t.clientY-e.top)*(this.target.height/e.height);var i=this.interactiveItems.length;this.mouse.global;for(var r=0;i>r;r++){var n=this.interactiveItems[r];n.mousemove&&n.mousemove(this.mouse)}},o.InteractionManager.prototype.onMouseDown=function(t){t.preventDefault();var e=this.interactiveItems.length;this.mouse.global,this.stage;for(var i=0;e>i;i++){var r=this.interactiveItems[i];if((r.mousedown||r.click)&&(r.__mouseIsDown=!0,r.__hit=this.hitTest(r,this.mouse),r.__hit&&(r.mousedown&&r.mousedown(this.mouse),r.__isDown=!0,!r.interactiveChildren)))break}},o.InteractionManager.prototype.onMouseUp=function(){this.mouse.global;for(var t=this.interactiveItems.length,e=!1,i=0;t>i;i++){var r=this.interactiveItems[i];(r.mouseup||r.mouseupoutside||r.click)&&(r.__hit=this.hitTest(r,this.mouse),r.__hit&&!e?(r.mouseup&&r.mouseup(this.mouse),r.__isDown&&r.click&&r.click(this.mouse),r.interactiveChildren||(e=!0)):r.__isDown&&r.mouseupoutside&&r.mouseupoutside(this.mouse),r.__isDown=!1)}},o.InteractionManager.prototype.hitTest=function(t,e){var i=e.global;if(!t.visible)return!1;var r=t instanceof o.Sprite,n=t.worldTransform,s=n[0],a=n[1],h=n[2],l=n[3],u=n[4],c=n[5],d=1/(s*u+a*-l),p=u*d*i.x+-a*d*i.y+(c*a-h*u)*d,f=s*d*i.y+-l*d*i.x+(-c*s+h*l)*d;if(t.hitArea){var v=t.hitArea;if(t.hitArea instanceof o.Polygon){for(var m=!1,g=0,x=t.hitArea.points.length-1;t.hitArea.points.length>g;x=g++){var b=t.hitArea.points[g].x,y=t.hitArea.points[g].y,T=t.hitArea.points[x].x,w=t.hitArea.points[x].y,_=y>f!=w>f&&(T-b)*(f-y)/(w-y)+b>p;_&&(m=!m)}if(m)return r&&(e.target=t),!0}else{var A=v.x;if(p>A&&A+v.width>p){var R=v.y;if(f>R&&R+v.height>f)return r&&(e.target=t),!0}}}else if(r){var R,S=t.texture.frame.width,L=t.texture.frame.height,A=-S*t.anchor.x;if(p>A&&A+S>p&&(R=-L*t.anchor.y,f>R&&R+L>f))return e.target=t,!0}for(var C=t.children.length,g=0;C>g;g++){var E=t.children[g],B=this.hitTest(E,e);if(B)return!0}return!1},o.InteractionManager.prototype.onTouchMove=function(t){for(var e=this.target.view.getBoundingClientRect(),i=t.changedTouches,r=0;i.length>r;r++){var n=i[r],s=this.touchs[n.identifier];s.global.x=(n.clientX-e.left)*(this.target.width/e.width),s.global.y=(n.clientY-e.top)*(this.target.height/e.height)}for(var a=this.interactiveItems.length,r=0;a>r;r++){var o=this.interactiveItems[r];o.touchmove&&o.touchmove(s)}},o.InteractionManager.prototype.onTouchStart=function(t){t.preventDefault();for(var e=this.target.view.getBoundingClientRect(),i=t.changedTouches,r=0;i.length>r;r++){var n=i[r],s=this.pool.pop();s||(s=new o.InteractionData),this.touchs[n.identifier]=s,s.global.x=(n.clientX-e.left)*(this.target.width/e.width),s.global.y=(n.clientY-e.top)*(this.target.height/e.height);for(var a=this.interactiveItems.length,h=0;a>h;h++){var l=this.interactiveItems[h];if((l.touchstart||l.tap)&&(l.__hit=this.hitTest(l,s),l.__hit&&(l.touchstart&&l.touchstart(s),l.__isDown=!0,l.__touchData=s,!l.interactiveChildren)))break}}},o.InteractionManager.prototype.onTouchEnd=function(t){for(var e=this.target.view.getBoundingClientRect(),i=t.changedTouches,r=0;i.length>r;r++){var n=i[r],s=this.touchs[n.identifier],a=!1;s.global.x=(n.clientX-e.left)*(this.target.width/e.width),s.global.y=(n.clientY-e.top)*(this.target.height/e.height);for(var o=this.interactiveItems.length,h=0;o>h;h++){var l=this.interactiveItems[h],u=l.__touchData;l.__hit=this.hitTest(l,s),u==s&&((l.touchend||l.tap)&&(l.__hit&&!a?(l.touchend&&l.touchend(s),l.__isDown&&l.tap&&l.tap(s),l.interactiveChildren||(a=!0)):l.__isDown&&l.touchendoutside&&l.touchendoutside(s),l.__isDown=!1),l.__touchData=null)}this.pool.push(s),this.touchs[n.identifier]=null}},o.InteractionData=function(){this.global=new o.Point,this.local=new o.Point,this.target},o.InteractionData.prototype.getLocalPosition=function(t){var e=t.worldTransform,i=this.global,r=e[0],n=e[1],s=e[2],a=e[3],h=e[4],l=e[5],u=1/(r*h+n*-a);return new o.Point(h*u*i.x+-n*u*i.y+(l*n-s*h)*u,r*u*i.y+-a*u*i.x+(-l*r+s*a)*u)},o.InteractionData.constructor=o.InteractionData,o.Stage=function(t,e){o.DisplayObjectContainer.call(this),this.worldTransform=o.mat3.create(),this.__childrenAdded=[],this.__childrenRemoved=[],this.childIndex=0,this.stage=this,this.stage.hitArea=new o.Rectangle(0,0,1e5,1e5),this.interactive=!!e,this.interactionManager=new o.InteractionManager(this),this.setBackgroundColor(t),this.worldVisible=!0,this.stage.dirty=!0},o.Stage.constructor=o.Stage,o.Stage.prototype=Object.create(o.DisplayObjectContainer.prototype),o.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var t=0,e=this.children.length;e>t;t++)this.children[t].updateTransform();this.dirty&&(this.dirty=!1,this.interactionManager.dirty=!0),this.interactive&&this.interactionManager.update()},o.Stage.prototype.setBackgroundColor=function(t){this.backgroundColor=t||0,this.backgroundColorSplit=e(this.backgroundColor);var i=this.backgroundColor.toString(16);i="000000".substr(0,6-i.length)+i,this.backgroundColorString="#"+i},o.Stage.prototype.getMousePosition=function(){return this.interactionManager.mouse.global},o.Stage.prototype.__addChild=function(t){if(t.interactive&&(this.dirty=!0),t.stage=this,t.children)for(var e=0;t.children.length>e;e++)this.__addChild(t.children[e])},o.Stage.prototype.__removeChild=function(t){if(t.interactive&&(this.dirty=!0),t.stage=void 0,t.children)for(var e=0,i=t.children.length;i>e;e++)this.__removeChild(t.children[e])};for(var h=0,l=["ms","moz","webkit","o"],u=0;l.length>u&&!window.requestAnimationFrame;++u)window.requestAnimationFrame=window[l[u]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[l[u]+"CancelAnimationFrame"]||window[l[u]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var e=(new Date).getTime(),i=Math.max(0,16-(e-h)),r=window.setTimeout(function(){t(e+i)},i);return h=e+i,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)}),window.requestAnimFrame=window.requestAnimationFrame,"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(){var t=Array.prototype.slice;return function(e){function i(){var s=n.concat(t.call(arguments));r.apply(this instanceof i?this:e,s)}var r=this,n=t.call(arguments,1);if("function"!=typeof r)throw new TypeError;return i.prototype=function s(t){return t&&(s.prototype=t),this instanceof s?void 0:new s}(r.prototype),i}}());var c=o.AjaxRequest=function(){var t=["Msxml2.XMLHTTP","Microsoft.XMLHTTP"];if(!window.ActiveXObject)return window.XMLHttpRequest?new XMLHttpRequest:!1;for(var e=0;t.length>e;e++)try{return new ActiveXObject(t[e])}catch(i){}};o.EventTarget=function(){var t={};this.addEventListener=this.on=function(e,i){void 0===t[e]&&(t[e]=[]),-1===t[e].indexOf(i)&&t[e].push(i)},this.dispatchEvent=this.emit=function(e){for(var i in t[e.type])t[e.type][i](e)},this.removeEventListener=this.off=function(e,i){var r=t[e].indexOf(i);-1!==r&&t[e].splice(r,1)}},o.autoDetectRenderer=function(t,e,i,r){t||(t=800),e||(e=600);var n=function(){try{return!!window.WebGLRenderingContext&&!!document.createElement("canvas").getContext("experimental-webgl")}catch(t){return!1}}();return n?new o.WebGLRenderer(t,e,i,r):new o.CanvasRenderer(t,e,i,r)},o.shaderFragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y));","gl_FragColor = gl_FragColor * vColor;","}"],o.shaderVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform mat4 uMVMatrix;","varying vec2 vTextureCoord;","varying float vColor;","void main(void) {","gl_Position = uMVMatrix * vec4(aVertexPosition, 1.0, 1.0);","vTextureCoord = aTextureCoord;","vColor = aColor;","}"],o.CompileVertexShader=function(t,e){return o._CompileShader(t,e,t.VERTEX_SHADER)},o.CompileFragmentShader=function(t,e){return o._CompileShader(t,e,t.FRAGMENT_SHADER)},o._CompileShader=function(t,e,i){var r=e.join("\n"),n=t.createShader(i);return t.shaderSource(n,r),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(alert(t.getShaderInfoLog(n)),null)},o.activateDefaultShader=function(){var t=o.gl,e=o.shaderProgram;t.useProgram(e),t.enableVertexAttribArray(e.vertexPositionAttribute),t.enableVertexAttribArray(e.textureCoordAttribute),t.enableVertexAttribArray(e.colorAttribute)},o.activatePrimitiveShader=function(){var t=o.gl;t.disableVertexAttribArray(o.shaderProgram.textureCoordAttribute),t.disableVertexAttribArray(o.shaderProgram.colorAttribute);var e=o.shaderProgram2;t.useProgram(e),t.enableVertexAttribArray(e.vertexPositionAttribute),t.enableVertexAttribArray(o.shaderProgram2.colorAttribute)},o.WebGLGraphics=function(){},o.WebGLGraphics.constructor=o.WebGLGraphics,o.WebGLGraphics.renderGraphics=function(t){o.activatePrimitiveShader();var e=o.gl;t._webGL||(t._webGL={points:[],lastPosition:new o.Point,lastIndex:0,buffer:e.createBuffer()}),t.dirty&&(t.dirty=!1,t.clearDirty&&(t.clearDirty=!1,t._webGL.lastIndex=0,t._webGL.points=[]),o.WebGLGraphics.initGraphics(t)),e.uniformMatrix4fv(o.shaderProgram2.mvMatrixUniform,!1,o.projectionMatrix),e.bindBuffer(e.ARRAY_BUFFER,t._webGL.buffer),e.vertexAttribPointer(o.shaderProgram2.vertexPositionAttribute,2,e.FLOAT,!1,24,0),e.vertexAttribPointer(o.shaderProgram2.colorAttribute,4,e.FLOAT,!1,24,8),e.drawArrays(e.TRIANGLE_STRIP,0,t._webGL.glPoints.length/6),o.activateDefaultShader()},o.WebGLGraphics.initGraphics=function(t){for(var e=t._webGL.lastIndex;t.graphicsData.length>e;e++){var i=t.graphicsData[e];i.type==o.Graphics.POLY?i.lineWidth>0&&o.WebGLGraphics.buildLine(i,t._webGL):i.type==o.Graphics.RECT?o.WebGLGraphics.buildRectangle(i,t._webGL):i.type==o.Graphics.CIRC&&o.WebGLGraphics.buildCircle(i,t._webGL)}t._webGL.lastIndex=t.graphicsData.length,t._webGL.glPoints=new Float32Array(t._webGL.points);var r=o.gl;r.bindBuffer(r.ARRAY_BUFFER,t._webGL.buffer),r.bufferData(r.ARRAY_BUFFER,t._webGL.glPoints,r.STATIC_DRAW)},o.WebGLGraphics.buildRectangle=function(t,i){var r=t.points,n=r[0],s=r[1],a=r[2],h=r[3];if(t.fill){var l=e(t.fillColor),u=t.fillAlpha,c=l[0]*u,d=l[1]*u,p=l[2]*u,f=i.points;f.push(i.lastPosition.x,i.lastPosition.y,1,1,1,1),f.push(n,s,1,1,1,1),f.push(n,s),f.push(c,d,p,u),f.push(n+a,s),f.push(c,d,p,u),f.push(n,s+h),f.push(c,d,p,u),f.push(n+a,s+h),f.push(c,d,p,u),i.lastPosition.x=n+a,i.lastPosition.y=s+h}t.lineWidth&&(t.points=[n,s,n+a,s,n+a,s+h,n,s+h,n,s],o.WebGLGraphics.buildLine(t,i))},o.WebGLGraphics.buildCircle=function(t,i){var r=t.points,n=r[0],s=r[1],a=r[2],h=40,l=2*Math.PI/h;if(t.fill){var u=e(t.fillColor),c=t.fillAlpha,d=u[0]*c,p=u[1]*c,f=u[2]*c,v=i.points;v.push(i.lastPosition.x,i.lastPosition.y,1,1,1,1),v.push(n,s,1,1,1,1);for(var m=0;h+1>m;m++)v.push(n,s),v.push(d,p,f,c),v.push(n+Math.sin(l*m)*a,s+Math.cos(l*m)*a),v.push(d,p,f,c);v.push(n,s),v.push(1,0,0,1),i.lastPosition.x=n,i.lastPosition.y=s}if(t.lineWidth){t.points=[];for(var m=0;h+1>m;m++)t.points.push(n+Math.sin(l*m)*a,s+Math.cos(l*m)*a);o.WebGLGraphics.buildLine(t,i)}},o.WebGLGraphics.buildLine=function(t,r){var s=t.points;if(0!=s.length){var a=new o.Point(s[0],s[1]),h=new o.Point(s[s.length-2],s[s.length-1]);if(a.x==h.x&&a.y==h.y){s.pop(),s.pop(),h=new o.Point(s[s.length-2],s[s.length-1]);var l=h.x+.5*(a.x-h.x),u=h.y+.5*(a.y-h.y);s.unshift(l,u),s.push(l,u)}var c=r.points,d=s.length/2,p=t.lineWidth/2,f=e(t.lineColor),v=t.lineAlpha,m=f[0]*v,g=f[1]*v,x=f[2]*v,b=new o.Point(s[0],s[1]),y=new o.Point(s[2],s[3]),T=i(b,y),w=Math.sqrt(T.x*T.x+T.y*T.y);T.x/=w,T.y/=w,T.x*=p,T.y*=p,c.push(r.lastPosition.x,r.lastPosition.y,1,1,1,1),c.push(s[0]-T.x,s[1]-T.y,1,1,1,1),c.push(s[0]-T.x,s[1]-T.y),c.push(m,g,x,v),c.push(s[0]+T.x,s[1]+T.y),c.push(m,g,x,v);for(var _=1;d-1>_;_++){var b=new o.Point(s[2*(_-1)],s[2*(_-1)+1]),y=new o.Point(s[2*_],s[2*_+1]),A=new o.Point(s[2*(_+1)],s[2*(_+1)+1]),T=i(b,y),w=Math.sqrt(T.x*T.x+T.y*T.y);T.x/=w,T.y/=w,T.x*=p,T.y*=p;var R=i(y,A),S=Math.sqrt(R.x*R.x+R.y*R.y);R.x/=S,R.y/=S,R.x*=p,R.y*=p;var L=new o.Point(-T.x+y.x,-T.y+y.y),C=new o.Point(-T.x+b.x,-T.y+b.y),E=new o.Point(-R.x+y.x,-R.y+y.y),B=new o.Point(-R.x+A.x,-R.y+A.y),F=n(L,C,E,B),G=(F.x-y.x)*(F.x-y.x)+(F.y-y.y)+(F.y-y.y);if(G>19600){var P=new o.Point(T.x-R.x,T.y-R.y),I=Math.sqrt(P.x*P.x+P.y*P.y);P.x/=I,P.y/=I,P.x*=p,P.y*=p,c.push(y.x-P.x,y.y-P.y),c.push(m,g,x,v),c.push(y.x+P.x,y.y+P.y),c.push(m,g,x,v),c.push(y.x-P.x,y.y-P.y),c.push(m,g,x,v)}else c.push(F.x,F.y),c.push(m,g,x,v),c.push(y.x-(F.x-y.x),y.y-(F.y-y.y)),c.push(m,g,x,v)}var b=new o.Point(s[2*(d-2)],s[2*(d-2)+1]),y=new o.Point(s[2*(d-1)],s[2*(d-1)+1]),T=i(b,y),w=Math.sqrt(T.x*T.x+T.y*T.y);T.x/=w,T.y/=w,T.x*=p,T.y*=p,c.push(y.x-T.x,y.y-T.y),c.push(m,g,x,v),c.push(y.x+T.x,y.y+T.y),c.push(m,g,x,v),r.lastPosition.x=y.x+T.x,r.lastPosition.y=y.y+T.y}},o.primitiveShaderFragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","gl_FragColor = vColor;","}"],o.primitiveShaderVertexSrc=["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat4 uMVMatrix;","varying vec4 vColor;","void main(void) {","gl_Position = uMVMatrix * vec4(aVertexPosition, 1.0, 1.0);","vColor = aColor;","}"],o.WebGLGraphics.initShaders=function(){var t=o.gl,e=o.CompileFragmentShader(t,o.primitiveShaderFragmentSrc),i=o.CompileVertexShader(t,o.primitiveShaderVertexSrc);o.shaderProgram2=t.createProgram();var r=o.shaderProgram2;t.attachShader(r,i),t.attachShader(r,e),t.linkProgram(r),t.getProgramParameter(r,t.LINK_STATUS)||alert("Could not initialise shaders"),t.useProgram(r),r.vertexPositionAttribute=t.getAttribLocation(r,"aVertexPosition"),r.colorAttribute=t.getAttribLocation(r,"aColor"),r.mvMatrixUniform=t.getUniformLocation(r,"uMVMatrix")},o._defaultFrame=new o.Rectangle(0,0,1,1),o.gl,o.WebGLRenderer=function(t,e,i,r){this.transparent=!!r,this.width=t||800,this.height=e||600,this.view=i||document.createElement("canvas"),this.view.width=this.width,this.view.height=this.height;var n=this;this.view.addEventListener("webglcontextlost",function(t){n.handleContextLost(t)},!1),this.view.addEventListener("webglcontextrestored",function(t){n.handleContextRestored(t)},!1),this.batchs=[];try{o.gl=this.gl=this.view.getContext("experimental-webgl",{alpha:this.transparent,antialias:!1,premultipliedAlpha:!1})}catch(s){throw Error(" This browser does not support webGL. Try using the canvas renderer"+this)}o.WebGLGraphics.initShaders(),this.initShaders();var a=this.gl;o.WebGLRenderer.gl=a,this.batch=new o.WebGLBatch(a),a.disable(a.DEPTH_TEST),a.disable(a.CULL_FACE),a.enable(a.BLEND),a.colorMask(!0,!0,!0,this.transparent),this.projectionMatrix=o.mat4.create(),this.resize(this.width,this.height),this.contextLost=!1,this.stageRenderGroup=new o.WebGLRenderGroup(this.gl)},o.WebGLRenderer.constructor=o.WebGLRenderer,o.WebGLRenderer.getBatch=function(){return 0==o._batchs.length?new o.WebGLBatch(o.WebGLRenderer.gl):o._batchs.pop()},o.WebGLRenderer.returnBatch=function(t){t.clean(),o._batchs.push(t)},o.WebGLRenderer.prototype.initShaders=function(){var t=this.gl,e=o.CompileFragmentShader(t,o.shaderFragmentSrc),i=o.CompileVertexShader(t,o.shaderVertexSrc);o.shaderProgram=t.createProgram();var r=o.shaderProgram;t.attachShader(r,i),t.attachShader(r,e),t.linkProgram(r),t.getProgramParameter(r,t.LINK_STATUS)||alert("Could not initialise shaders"),t.useProgram(r),r.vertexPositionAttribute=t.getAttribLocation(r,"aVertexPosition"),r.textureCoordAttribute=t.getAttribLocation(r,"aTextureCoord"),r.colorAttribute=t.getAttribLocation(r,"aColor"),r.mvMatrixUniform=t.getUniformLocation(r,"uMVMatrix"),r.samplerUniform=t.getUniformLocation(r,"uSampler"),o.activateDefaultShader()},o.WebGLRenderer.prototype.render=function(t){if(!this.contextLost){this.__stage!==t&&(this.__stage=t,this.stageRenderGroup.setRenderable(t)),o.WebGLRenderer.updateTextures(),t.updateTransform();
var e=this.gl;if(e.colorMask(!0,!0,!0,this.transparent),e.viewport(0,0,this.width,this.height),e.bindFramebuffer(e.FRAMEBUFFER,null),e.clearColor(t.backgroundColorSplit[0],t.backgroundColorSplit[1],t.backgroundColorSplit[2],!this.transparent),e.clear(e.COLOR_BUFFER_BIT),o.projectionMatrix=this.projectionMatrix,this.stageRenderGroup.backgroundColor=t.backgroundColorSplit,this.stageRenderGroup.render(this.projectionMatrix),t.interactive&&(t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this))),o.Texture.frameUpdates.length>0){for(var i=0;o.Texture.frameUpdates.length>i;i++)o.Texture.frameUpdates[i].updateFrame=!1;o.Texture.frameUpdates=[]}}},o.WebGLRenderer.updateTextures=function(){for(var t=0;o.texturesToUpdate.length>t;t++)this.updateTexture(o.texturesToUpdate[t]);for(var t=0;o.texturesToDestroy.length>t;t++)this.destroyTexture(o.texturesToDestroy[t]);o.texturesToUpdate=[],o.texturesToDestroy=[]},o.WebGLRenderer.updateTexture=function(t){var e=o.gl;t._glTexture||(t._glTexture=e.createTexture()),t.hasLoaded&&(e.bindTexture(e.TEXTURE_2D,t._glTexture),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.source),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),t._powerOf2?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT)):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),e.bindTexture(e.TEXTURE_2D,null))},o.WebGLRenderer.prototype.destroyTexture=function(t){var e=this.gl;t._glTexture&&(t._glTexture=e.createTexture(),e.deleteTexture(e.TEXTURE_2D,t._glTexture))},o.WebGLRenderer.prototype.resize=function(t,e){this.width=t,this.height=e,this.view.width=t,this.view.height=e,this.gl.viewport(0,0,this.width,this.height);var i=this.projectionMatrix;i[0]=2/this.width,i[5]=-2/this.height,i[12]=-1,i[13]=1},o.WebGLRenderer.prototype.handleContextLost=function(t){t.preventDefault(),this.contextLost=!0},o.WebGLRenderer.prototype.handleContextRestored=function(){this.gl=this.view.getContext("experimental-webgl",{alpha:!0}),this.initShaders();for(var t=0;o.TextureCache.length>t;t++)this.updateTexture(o.TextureCache[t]);for(var t=0;this.batchs.length>t;t++)this.batchs[t].restoreLostContext(this.gl),this.batchs[t].dirty=!0;o._restoreBatchs(this.gl),this.contextLost=!1},o._batchs=[],o._getBatch=function(t){return 0==o._batchs.length?new o.WebGLBatch(t):o._batchs.pop()},o._returnBatch=function(t){t.clean(),o._batchs.push(t)},o._restoreBatchs=function(t){for(var e=0;o._batchs.length>e;e++)o._batchs[e].restoreLostContext(t)},o.WebGLBatch=function(t){this.gl=t,this.size=0,this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.uvBuffer=t.createBuffer(),this.colorBuffer=t.createBuffer(),this.blendMode=o.blendModes.NORMAL,this.dynamicSize=1},o.WebGLBatch.constructor=o.WebGLBatch,o.WebGLBatch.prototype.clean=function(){this.verticies=[],this.uvs=[],this.indices=[],this.colors=[],this.dynamicSize=1,this.texture=null,this.last=null,this.size=0,this.head,this.tail},o.WebGLBatch.prototype.restoreLostContext=function(t){this.gl=t,this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.uvBuffer=t.createBuffer(),this.colorBuffer=t.createBuffer()},o.WebGLBatch.prototype.init=function(t){t.batch=this,this.dirty=!0,this.blendMode=t.blendMode,this.texture=t.texture.baseTexture,this.head=t,this.tail=t,this.size=1,this.growBatch()},o.WebGLBatch.prototype.insertBefore=function(t,e){this.size++,t.batch=this,this.dirty=!0;var i=e.__prev;e.__prev=t,t.__next=e,i?(t.__prev=i,i.__next=t):this.head=t},o.WebGLBatch.prototype.insertAfter=function(t,e){this.size++,t.batch=this,this.dirty=!0;var i=e.__next;e.__next=t,t.__prev=e,i?(t.__next=i,i.__prev=t):this.tail=t},o.WebGLBatch.prototype.remove=function(t){return this.size--,0==this.size?(t.batch=null,t.__prev=null,t.__next=null,void 0):(t.__prev?t.__prev.__next=t.__next:(this.head=t.__next,this.head.__prev=null),t.__next?t.__next.__prev=t.__prev:(this.tail=t.__prev,this.tail.__next=null),t.batch=null,t.__next=null,t.__prev=null,this.dirty=!0,void 0)},o.WebGLBatch.prototype.split=function(t){this.dirty=!0;var e=new o.WebGLBatch(this.gl);e.init(t),e.texture=this.texture,e.tail=this.tail,this.tail=t.__prev,this.tail.__next=null,t.__prev=null;for(var i=0;t;)i++,t.batch=e,t=t.__next;return e.size=i,this.size-=i,e},o.WebGLBatch.prototype.merge=function(t){this.dirty=!0,this.tail.__next=t.head,t.head.__prev=this.tail,this.size+=t.size,this.tail=t.tail;for(var e=t.head;e;)e.batch=this,e=e.__next},o.WebGLBatch.prototype.growBatch=function(){var t=this.gl;this.dynamicSize=1==this.size?1:1.5*this.size,this.verticies=new Float32Array(8*this.dynamicSize),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.verticies,t.DYNAMIC_DRAW),this.uvs=new Float32Array(8*this.dynamicSize),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),t.bufferData(t.ARRAY_BUFFER,this.uvs,t.DYNAMIC_DRAW),this.dirtyUVS=!0,this.colors=new Float32Array(4*this.dynamicSize),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,this.colors,t.DYNAMIC_DRAW),this.dirtyColors=!0,this.indices=new Uint16Array(6*this.dynamicSize);for(var e=this.indices.length/6,i=0;e>i;i++){var r=6*i,n=4*i;this.indices[r+0]=n+0,this.indices[r+1]=n+1,this.indices[r+2]=n+2,this.indices[r+3]=n+0,this.indices[r+4]=n+2,this.indices[r+5]=n+3}t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW)},o.WebGLBatch.prototype.refresh=function(){this.gl,this.dynamicSize<this.size&&this.growBatch();for(var t,e=0,i=this.head;i;){t=8*e;var r=i.texture,n=r.frame,s=r.baseTexture.width,a=r.baseTexture.height;this.uvs[t+0]=n.x/s,this.uvs[t+1]=n.y/a,this.uvs[t+2]=(n.x+n.width)/s,this.uvs[t+3]=n.y/a,this.uvs[t+4]=(n.x+n.width)/s,this.uvs[t+5]=(n.y+n.height)/a,this.uvs[t+6]=n.x/s,this.uvs[t+7]=(n.y+n.height)/a,i.updateFrame=!1,colorIndex=4*e,this.colors[colorIndex]=this.colors[colorIndex+1]=this.colors[colorIndex+2]=this.colors[colorIndex+3]=i.worldAlpha,i=i.__next,e++}this.dirtyUVS=!0,this.dirtyColors=!0},o.WebGLBatch.prototype.update=function(){this.gl;for(var t,e,i,r,n,s,a,o,h,l,u,c,d,p,f,v,m=0,g=this.head;g;){if(g.worldVisible){if(e=g.texture.frame.width,i=g.texture.frame.height,r=g.anchor.x,n=g.anchor.y,s=e*(1-r),a=e*-r,o=i*(1-n),h=i*-n,l=8*m,t=g.worldTransform,u=t[0],c=t[3],d=t[1],p=t[4],f=t[2],v=t[5],this.verticies[l+0]=u*a+d*h+f,this.verticies[l+1]=p*h+c*a+v,this.verticies[l+2]=u*s+d*h+f,this.verticies[l+3]=p*h+c*s+v,this.verticies[l+4]=u*s+d*o+f,this.verticies[l+5]=p*o+c*s+v,this.verticies[l+6]=u*a+d*o+f,this.verticies[l+7]=p*o+c*a+v,g.updateFrame||g.texture.updateFrame){this.dirtyUVS=!0;var x=g.texture,b=x.frame,y=x.baseTexture.width,T=x.baseTexture.height;this.uvs[l+0]=b.x/y,this.uvs[l+1]=b.y/T,this.uvs[l+2]=(b.x+b.width)/y,this.uvs[l+3]=b.y/T,this.uvs[l+4]=(b.x+b.width)/y,this.uvs[l+5]=(b.y+b.height)/T,this.uvs[l+6]=b.x/y,this.uvs[l+7]=(b.y+b.height)/T,g.updateFrame=!1}if(g.cacheAlpha!=g.worldAlpha){g.cacheAlpha=g.worldAlpha;var w=4*m;this.colors[w]=this.colors[w+1]=this.colors[w+2]=this.colors[w+3]=g.worldAlpha,this.dirtyColors=!0}}else l=8*m,this.verticies[l+0]=0,this.verticies[l+1]=0,this.verticies[l+2]=0,this.verticies[l+3]=0,this.verticies[l+4]=0,this.verticies[l+5]=0,this.verticies[l+6]=0,this.verticies[l+7]=0;m++,g=g.__next}},o.WebGLBatch.prototype.render=function(t,e){if(t=t||0,void 0==e&&(e=this.size),this.dirty&&(this.refresh(),this.dirty=!1),0!=this.size){this.update();var i=this.gl;i.blendFunc(i.ONE,i.ONE_MINUS_SRC_ALPHA);var r=o.shaderProgram;i.useProgram(r),i.bindBuffer(i.ARRAY_BUFFER,this.vertexBuffer),i.bufferSubData(i.ARRAY_BUFFER,0,this.verticies),i.vertexAttribPointer(r.vertexPositionAttribute,2,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,this.uvBuffer),this.dirtyUVS&&(this.dirtyUVS=!1,i.bufferSubData(i.ARRAY_BUFFER,0,this.uvs)),i.vertexAttribPointer(r.textureCoordAttribute,2,i.FLOAT,!1,0,0),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,this.texture._glTexture),i.bindBuffer(i.ARRAY_BUFFER,this.colorBuffer),this.dirtyColors&&(this.dirtyColors=!1,i.bufferSubData(i.ARRAY_BUFFER,0,this.colors)),i.vertexAttribPointer(r.colorAttribute,1,i.FLOAT,!1,0,0),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var n=e-t;i.drawElements(i.TRIANGLES,6*n,i.UNSIGNED_SHORT,6*2*t)}},o.WebGLRenderGroup=function(t){this.gl=t,this.root,this.backgroundColor,this.batchs=[],this.toRemove=[]},o.WebGLRenderGroup.constructor=o.WebGLRenderGroup,o.WebGLRenderGroup.prototype.setRenderable=function(t){this.root&&this.removeDisplayObjectAndChildren(this.root),t.worldVisible=t.visible,this.root=t,this.addDisplayObjectAndChildren(t)},o.WebGLRenderGroup.prototype.render=function(t){o.WebGLRenderer.updateTextures();var e=this.gl;e.uniformMatrix4fv(o.shaderProgram.mvMatrixUniform,!1,t),this.checkVisibility(this.root,this.root.visible);for(var i,r=0;this.batchs.length>r;r++)i=this.batchs[r],i instanceof o.WebGLBatch?this.batchs[r].render():i instanceof o.TilingSprite?i.visible&&this.renderTilingSprite(i,t):i instanceof o.Strip?i.visible&&this.renderStrip(i,t):i instanceof o.Graphics&&i.visible&&o.WebGLGraphics.renderGraphics(i)},o.WebGLRenderGroup.prototype.renderSpecific=function(t,e){o.WebGLRenderer.updateTextures();var i=this.gl;this.checkVisibility(t,t.visible),i.uniformMatrix4fv(o.shaderProgram.mvMatrixUniform,!1,e);var r,n,s,a,h=t.renderable?t:this.getNextRenderable(t),l=h.batch;if(h instanceof o.Sprite){l=h.batch;var u=l.head;if(u==h)r=0;else for(r=1;u.__next!=h;)r++,u=u.__next}else l=h;for(var c,d=t,p=t;p.children.length>0;)p=p.children[p.children.length-1],p.renderable&&(d=p);if(d instanceof o.Sprite){c=d.batch;var u=c.head;if(u==d)s=0;else for(s=1;u.__next!=d;)s++,u=u.__next}else c=d;if(l==c)return l instanceof o.WebGLBatch?l.render(r,s+1):l instanceof o.TilingSprite?l.visible&&this.renderTilingSprite(l,e):l instanceof o.Strip?l.visible&&this.renderStrip(l,e):l instanceof o.CustomRenderable?l.visible&&l.renderWebGL(this,e):renderable instanceof o.Graphics&&renderable.visible&&o.WebGLGraphics.renderGraphics(renderable),void 0;n=this.batchs.indexOf(l),a=this.batchs.indexOf(c),l instanceof o.WebGLBatch?l.render(r):l instanceof o.TilingSprite?l.visible&&this.renderTilingSprite(l,e):l instanceof o.Strip?l.visible&&this.renderStrip(l,e):l instanceof o.CustomRenderable?l.visible&&l.renderWebGL(this,e):renderable instanceof o.Graphics&&renderable.visible&&o.WebGLGraphics.renderGraphics(renderable);for(var f=n+1;a>f;f++)renderable=this.batchs[f],renderable instanceof o.WebGLBatch?this.batchs[f].render():renderable instanceof o.TilingSprite?renderable.visible&&this.renderTilingSprite(renderable,e):renderable instanceof o.Strip?renderable.visible&&this.renderStrip(renderable,e):renderable instanceof o.CustomRenderable?renderable.visible&&renderable.renderWebGL(this,e):renderable instanceof o.Graphics&&renderable.visible&&o.WebGLGraphics.renderGraphics(renderable);c instanceof o.WebGLBatch?c.render(0,s+1):c instanceof o.TilingSprite?c.visible&&this.renderTilingSprite(c):c instanceof o.Strip?c.visible&&this.renderStrip(c):c instanceof o.CustomRenderable?c.visible&&c.renderWebGL(this,e):renderable instanceof o.Graphics&&renderable.visible&&o.WebGLGraphics.renderGraphics(renderable)},o.WebGLRenderGroup.prototype.checkVisibility=function(t,e){for(var i=t.children,r=0;i.length>r;r++){var n=i[r];n.worldVisible=n.visible&&e,n.textureChange&&(n.textureChange=!1,n.worldVisible&&(this.removeDisplayObject(n),this.addDisplayObject(n))),n.children.length>0&&this.checkVisibility(n,n.worldVisible)}},o.WebGLRenderGroup.prototype.updateTexture=function(t){if(1==t.batch.length)return t.batch.texture=t.texture.baseTexture,void 0;if(t.batch.texture!=t.texture.baseTexture)if(t.batch.head==t){var e=t.batch,i=this.batchs.indexOf(e),r=this.batchs[i-1];if(e.remove(t),r)if(r.texture==t.texture.baseTexture&&r.blendMode==t.blendMode)r.insertAfter(t,r.tail);else{var n=o.WebGLRenderer.getBatch();n.init(t),this.batchs.splice(i-1,0,n)}else{var n=o.WebGLRenderer.getBatch();n.init(t),this.batchs.splice(0,0,n)}}else if(t.batch.tail==t){var e=t.batch,i=this.batchs.indexOf(e),s=this.batchs[i+1];if(e.remove(t),s){if(s.texture==t.texture.baseTexture&&s.blendMode==t.blendMode)return s.insertBefore(t,s.head),void 0;var n=o.WebGLRenderer.getBatch();n.init(t),this.batchs.splice(i+1,0,n)}else{var n=o.WebGLRenderer.getBatch();n.init(t),this.batchs.push(n)}}else{var e=t.batch,a=e.split(t);a.remove(t);var n=o.WebGLRenderer.getBatch(),i=this.batchs.indexOf(e);n.init(t),this.batchs.splice(i+1,0,n,a)}},o.WebGLRenderGroup.prototype.addDisplayObject=function(t){if(t.__renderGroup&&t.__renderGroup.removeDisplayObjectAndChildren(t),t.__renderGroup=this,t.renderable){var e=this.getPreviousRenderable(t),i=this.getNextRenderable(t);if(t instanceof o.Sprite){var r,n;if(e instanceof o.Sprite){if(r=e.batch,r&&r.texture==t.texture.baseTexture&&r.blendMode==t.blendMode)return r.insertAfter(t,e),void 0}else r=e;if(i)if(i instanceof o.Sprite){if(n=i.batch){if(n.texture==t.texture.baseTexture&&n.blendMode==t.blendMode)return n.insertBefore(t,i),void 0;if(n==r){var s=r.split(i),a=o.WebGLRenderer.getBatch(),h=this.batchs.indexOf(r);return a.init(t),this.batchs.splice(h+1,0,a,s),void 0}}}else n=i;var a=o.WebGLRenderer.getBatch();if(a.init(t),r){var h=this.batchs.indexOf(r);this.batchs.splice(h+1,0,a)}else this.batchs.push(a)}else t instanceof o.TilingSprite?(this.initTilingSprite(t),this.batchs.push(t)):t instanceof o.Strip?(this.initStrip(t),this.batchs.push(t)):t instanceof o.Graphics&&this.batchs.push(t);this.batchUpdate=!0}},o.WebGLRenderGroup.prototype.addDisplayObjectAndChildren=function(t){this.addDisplayObject(t);for(var e=t.children,i=0;e.length>i;i++)this.addDisplayObjectAndChildren(e[i])},o.WebGLRenderGroup.prototype.removeDisplayObject=function(t){if(t.__renderGroup=null,t.renderable){var e;if(t instanceof o.Sprite){var i=t.batch;if(!i)return;i.remove(t),0==i.size&&(e=i)}else e=t;if(e){var r=this.batchs.indexOf(e);if(-1==r)return;if(0==r||r==this.batchs.length-1)return this.batchs.splice(r,1),e instanceof o.WebGLBatch&&o.WebGLRenderer.returnBatch(e),void 0;if(this.batchs[r-1]instanceof o.WebGLBatch&&this.batchs[r+1]instanceof o.WebGLBatch&&this.batchs[r-1].texture==this.batchs[r+1].texture&&this.batchs[r-1].blendMode==this.batchs[r+1].blendMode)return this.batchs[r-1].merge(this.batchs[r+1]),e instanceof o.WebGLBatch&&o.WebGLRenderer.returnBatch(e),o.WebGLRenderer.returnBatch(this.batchs[r+1]),this.batchs.splice(r,2),void 0;this.batchs.splice(r,1),e instanceof o.WebGLBatch&&o.WebGLRenderer.returnBatch(e)}}},o.WebGLRenderGroup.prototype.removeDisplayObjectAndChildren=function(t){if(t.__renderGroup==this){this.removeDisplayObject(t);for(var e=t.children,i=0;e.length>i;i++)this.removeDisplayObjectAndChildren(e[i])}},o.WebGLRenderGroup.prototype.getNextRenderable=function(t){var e=t;do{if(0==e.children.length){if(!e.parent)return null;for(;e.childIndex==e.parent.children.length-1;)if(e=e.parent,e==this.root||!e.parent){e=null;break}e&&(e=e.parent.children[e.childIndex+1])}else e=e.children[0];if(!e)break}while(!e.renderable||!e.__renderGroup);return e},o.WebGLRenderGroup.prototype.getPreviousRenderable=function(t){var e=t;do{if(0==e.childIndex){if(e=e.parent,!e)return null}else for(e=e.parent.children[e.childIndex-1];0!=e.children.length;)e=e.children[e.children.length-1];if(e==this.root)break}while(!e.renderable||!e.__renderGroup);return e},o.WebGLRenderGroup.prototype.initTilingSprite=function(t){var e=this.gl;t.verticies=new Float32Array([0,0,t.width,0,t.width,t.height,0,t.height]),t.uvs=new Float32Array([0,0,1,0,1,1,0,1]),t.colors=new Float32Array([1,1,1,1]),t.indices=new Uint16Array([0,1,3,2]),t._vertexBuffer=e.createBuffer(),t._indexBuffer=e.createBuffer(),t._uvBuffer=e.createBuffer(),t._colorBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,t._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,t.verticies,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,t._uvBuffer),e.bufferData(e.ARRAY_BUFFER,t.uvs,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,t._colorBuffer),e.bufferData(e.ARRAY_BUFFER,t.colors,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,t.indices,e.STATIC_DRAW),t.texture.baseTexture._glTexture?(e.bindTexture(e.TEXTURE_2D,t.texture.baseTexture._glTexture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),t.texture.baseTexture._powerOf2=!0):t.texture.baseTexture._powerOf2=!0},o.WebGLRenderGroup.prototype.renderStrip=function(t,e){var i=this.gl,r=o.shaderProgram,n=o.mat3.toMat4(t.worldTransform);o.mat4.transpose(n),o.mat4.multiply(e,n,n),i.uniformMatrix4fv(r.mvMatrixUniform,!1,n),t.blendMode==o.blendModes.NORMAL?i.blendFunc(i.ONE,i.ONE_MINUS_SRC_ALPHA):i.blendFunc(i.ONE,i.ONE_MINUS_SRC_COLOR),t.dirty?(t.dirty=!1,i.bindBuffer(i.ARRAY_BUFFER,t._vertexBuffer),i.bufferData(i.ARRAY_BUFFER,t.verticies,i.STATIC_DRAW),i.vertexAttribPointer(r.vertexPositionAttribute,2,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,t._uvBuffer),i.bufferData(i.ARRAY_BUFFER,t.uvs,i.STATIC_DRAW),i.vertexAttribPointer(r.textureCoordAttribute,2,i.FLOAT,!1,0,0),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,t.texture.baseTexture._glTexture),i.bindBuffer(i.ARRAY_BUFFER,t._colorBuffer),i.bufferData(i.ARRAY_BUFFER,t.colors,i.STATIC_DRAW),i.vertexAttribPointer(r.colorAttribute,1,i.FLOAT,!1,0,0),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t._indexBuffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,t.indices,i.STATIC_DRAW)):(i.bindBuffer(i.ARRAY_BUFFER,t._vertexBuffer),i.bufferSubData(i.ARRAY_BUFFER,0,t.verticies),i.vertexAttribPointer(r.vertexPositionAttribute,2,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,t._uvBuffer),i.vertexAttribPointer(r.textureCoordAttribute,2,i.FLOAT,!1,0,0),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,t.texture.baseTexture._glTexture),i.bindBuffer(i.ARRAY_BUFFER,t._colorBuffer),i.vertexAttribPointer(r.colorAttribute,1,i.FLOAT,!1,0,0),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t._indexBuffer)),i.drawElements(i.TRIANGLE_STRIP,t.indices.length,i.UNSIGNED_SHORT,0),i.uniformMatrix4fv(r.mvMatrixUniform,!1,e)},o.WebGLRenderGroup.prototype.renderTilingSprite=function(t,e){var i=this.gl;o.shaderProgram;var r=t.tilePosition,n=t.tileScale,s=r.x/t.texture.baseTexture.width,a=r.y/t.texture.baseTexture.height,h=t.width/t.texture.baseTexture.width/n.x,l=t.height/t.texture.baseTexture.height/n.y;t.uvs[0]=0-s,t.uvs[1]=0-a,t.uvs[2]=1*h-s,t.uvs[3]=0-a,t.uvs[4]=1*h-s,t.uvs[5]=1*l-a,t.uvs[6]=0-s,t.uvs[7]=1*l-a,i.bindBuffer(i.ARRAY_BUFFER,t._uvBuffer),i.bufferSubData(i.ARRAY_BUFFER,0,t.uvs),this.renderStrip(t,e)},o.WebGLRenderer.prototype.initStrip=function(t){var e=this.gl;this.shaderProgram,t._vertexBuffer=e.createBuffer(),t._indexBuffer=e.createBuffer(),t._uvBuffer=e.createBuffer(),t._colorBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,t._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,t.verticies,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,t._uvBuffer),e.bufferData(e.ARRAY_BUFFER,t.uvs,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,t._colorBuffer),e.bufferData(e.ARRAY_BUFFER,t.colors,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,t.indices,e.STATIC_DRAW)},o.CanvasRenderer=function(t,e,i,r){this.transparent=r,this.width=t||800,this.height=e||600,this.refresh=!0,this.view=i||document.createElement("canvas"),this.view.width=this.width,this.view.height=this.height,this.count=0,this.context=this.view.getContext("2d")},o.CanvasRenderer.constructor=o.CanvasRenderer,o.CanvasRenderer.prototype.render=function(t){o.texturesToUpdate=[],o.texturesToDestroy=[],t.updateTransform(),this.view.style.backgroundColor==t.backgroundColorString||this.transparent||(this.view.style.backgroundColor=t.backgroundColorString),this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.width,this.height),this.renderDisplayObject(t),t.interactive&&(t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this))),o.Texture.frameUpdates.length>0&&(o.Texture.frameUpdates=[])},o.CanvasRenderer.prototype.resize=function(t,e){this.width=t,this.height=e,this.view.width=t,this.view.height=e},o.CanvasRenderer.prototype.renderDisplayObject=function(t){var e=t.worldTransform,i=this.context;if(t.visible){if(t instanceof o.Sprite){var r=t.texture.frame;r&&(i.globalAlpha=t.worldAlpha,i.setTransform(e[0],e[3],e[1],e[4],e[2],e[5]),i.drawImage(t.texture.baseTexture.source,r.x,r.y,r.width,r.height,t.anchor.x*-r.width,t.anchor.y*-r.height,r.width,r.height))}else t instanceof o.Strip?(i.setTransform(e[0],e[3],e[1],e[4],e[2],e[5]),this.renderStrip(t)):t instanceof o.TilingSprite?(i.setTransform(e[0],e[3],e[1],e[4],e[2],e[5]),this.renderTilingSprite(t)):t instanceof o.CustomRenderable?t.renderCanvas(this):t instanceof o.Graphics&&o.CanvasGraphics.renderGraphics(t,i);if(t.children)for(var n=0;t.children.length>n;n++)this.renderDisplayObject(t.children[n]);this.context.setTransform(1,0,0,1,0,0)}},o.CanvasRenderer.prototype.renderStripFlat=function(t){var e=this.context,i=t.verticies;t.uvs;var r=i.length/2;this.count++,e.beginPath();for(var n=1;r-2>n;n++){var s=2*n,a=i[s],o=i[s+2],h=i[s+4],l=i[s+1],u=i[s+3],c=i[s+5];e.moveTo(a,l),e.lineTo(o,u),e.lineTo(h,c)}e.fillStyle="#FF0000",e.fill(),e.closePath()},o.CanvasRenderer.prototype.renderTilingSprite=function(t){var e=this.context;t.__tilePattern||(t.__tilePattern=e.createPattern(t.texture.baseTexture.source,"repeat")),e.beginPath();var i=t.tilePosition,r=t.tileScale;e.scale(r.x,r.y),e.translate(i.x,i.y),e.fillStyle=t.__tilePattern,e.fillRect(-i.x,-i.y,t.width/r.x,t.height/r.y),e.scale(1/r.x,1/r.y),e.translate(-i.x,-i.y),e.closePath()},o.CanvasRenderer.prototype.renderStrip=function(t){var e=this.context,i=t.verticies,r=t.uvs,n=i.length/2;this.count++;for(var s=1;n-2>s;s++){var a=2*s,o=i[a],h=i[a+2],l=i[a+4],u=i[a+1],c=i[a+3],d=i[a+5],p=r[a]*t.texture.width,f=r[a+2]*t.texture.width,v=r[a+4]*t.texture.width,m=r[a+1]*t.texture.height,g=r[a+3]*t.texture.height,x=r[a+5]*t.texture.height;e.save(),e.beginPath(),e.moveTo(o,u),e.lineTo(h,c),e.lineTo(l,d),e.closePath(),e.clip();var b=p*g+m*v+f*x-g*v-m*f-p*x,y=o*g+m*l+h*x-g*l-m*h-o*x,T=p*h+o*v+f*l-h*v-o*f-p*l,w=p*g*l+m*h*v+o*f*x-o*g*v-m*f*l-p*h*x,_=u*g+m*d+c*x-g*d-m*c-u*x,A=p*c+u*v+f*d-c*v-u*f-p*d,R=p*g*d+m*c*v+u*f*x-u*g*v-m*f*d-p*c*x;e.transform(y/b,_/b,T/b,A/b,w/b,R/b),e.drawImage(t.texture.baseTexture.source,0,0),e.restore()}},o.CanvasGraphics=function(){},o.CanvasGraphics.renderGraphics=function(t,e){for(var i=0;t.graphicsData.length>i;i++){var r=t.graphicsData[i],n=r.points;if(e.strokeStyle=color="#"+("00000"+(0|r.lineColor).toString(16)).substr(-6),e.lineWidth=r.lineWidth,e.globalAlpha=r.lineAlpha,r.type==o.Graphics.POLY){if(0>=r.lineWidth)continue;e.beginPath(),e.moveTo(n[0],n[1]);for(var s=1;n.length/2>s;s++)e.lineTo(n[2*s],n[2*s+1]);n[0]==n[n.length-2]&&n[1]==n[n.length-1]&&e.closePath(),e.stroke()}else r.type==o.Graphics.RECT?(r.fillColor&&(e.fillStyle=color="#"+("00000"+(0|r.fillColor).toString(16)).substr(-6),e.fillRect(n[0],n[1],n[2],n[3])),r.lineWidth&&e.strokeRect(n[0],n[1],n[2],n[3])):r.type==o.Graphics.CIRC&&(e.beginPath(),e.arc(n[0],n[1],n[2],0,2*Math.PI),e.closePath(),r.fill&&(e.fillStyle=color="#"+("00000"+(0|r.fillColor).toString(16)).substr(-6),e.fill()),r.lineWidth&&e.stroke())}},o.Graphics=function(){o.DisplayObjectContainer.call(this),this.renderable=!0,this.fillAlpha=1,this.lineWidth=2,this.lineColor="#FF0000",this.graphicsData=[]},o.Graphics.POLY=0,o.Graphics.RECT=1,o.Graphics.CIRC=2,o.Graphics.constructor=o.Graphics,o.Graphics.prototype=Object.create(o.DisplayObjectContainer.prototype),o.Graphics.prototype.lineStyle=function(t,e,i){this.lineWidth=t||0,this.lineColor=e||0,this.lineAlpha=void 0==i?1:i,this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,points:[],type:o.Graphics.POLY},this.graphicsData.push(this.currentPath)},o.Graphics.prototype.moveTo=function(t,e){this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,points:[],type:o.Graphics.POLY},this.currentPath.points.push(t,e),this.graphicsData.push(this.currentPath)},o.Graphics.prototype.lineTo=function(t,e){this.currentPath.points.push(t,e),this.dirty=!0},o.Graphics.prototype.beginFill=function(t,e){this.filling=!0,this.fillColor=t||0,this.fillAlpha=e||1},o.Graphics.prototype.endFill=function(){this.filling=!1,this.fillColor=null,this.fillAlpha=1},o.Graphics.prototype.updateTransform=function(){this.visible&&o.DisplayObject.prototype.updateTransform.call(this)},o.Graphics.prototype.drawRect=function(t,e,i,r){this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[t,e,i,r],type:o.Graphics.RECT},this.graphicsData.push(this.currentPath),this.dirty=!0},o.Graphics.prototype.drawCircle=function(t,e,i){this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[t,e,i],type:o.Graphics.CIRC},this.graphicsData.push(this.currentPath),this.dirty=!0},o.Graphics.prototype.clear=function(){this.dirty=!0,this.clearDirty=!0,this.graphicsData=[]},o.Strip=function(t,e,i){o.DisplayObjectContainer.call(this),this.texture=t,this.blendMode=o.blendModes.NORMAL;try{this.uvs=new Float32Array([0,1,1,1,1,0,0,1]),this.verticies=new Float32Array([0,0,0,0,0,0,0,0,0]),this.colors=new Float32Array([1,1,1,1]),this.indices=new Uint16Array([0,1,2,3])}catch(r){this.uvs=[0,1,1,1,1,0,0,1],this.verticies=[0,0,0,0,0,0,0,0,0],this.colors=[1,1,1,1],this.indices=[0,1,2,3]}this.width=e,this.height=i,t.baseTexture.hasLoaded?(this.width=this.texture.frame.width,this.height=this.texture.frame.height,this.updateFrame=!0):(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind)),this.renderable=!0},o.Strip.constructor=o.Strip,o.Strip.prototype=Object.create(o.DisplayObjectContainer.prototype),o.Strip.prototype.setTexture=function(t){this.texture=t,this.width=t.frame.width,this.height=t.frame.height,this.updateFrame=!0},o.Strip.prototype.onTextureUpdate=function(){this.updateFrame=!0},o.Rope=function(t,e){o.Strip.call(this,t),this.points=e;try{this.verticies=new Float32Array(4*e.length),this.uvs=new Float32Array(4*e.length),this.colors=new Float32Array(2*e.length),this.indices=new Uint16Array(2*e.length)}catch(i){this.verticies=verticies,this.uvs=uvs,this.colors=colors,this.indices=indices}this.refresh()},o.Rope.constructor=o.Rope,o.Rope.prototype=Object.create(o.Strip.prototype),o.Rope.prototype.refresh=function(){var t=this.points;if(!(1>t.length)){var e=this.uvs,i=this.indices,r=this.colors,n=t[0],s=t[0];this.count-=.2,e[0]=0,e[1]=1,e[2]=0,e[3]=1,r[0]=1,r[1]=1,i[0]=0,i[1]=1;for(var a=t.length,o=1;a>o;o++){var s=t[o],h=4*o,l=o/(a-1);o%2?(e[h]=l,e[h+1]=0,e[h+2]=l,e[h+3]=1):(e[h]=l,e[h+1]=0,e[h+2]=l,e[h+3]=1),h=2*o,r[h]=1,r[h+1]=1,h=2*o,i[h]=h,i[h+1]=h+1,n=s}}},o.Rope.prototype.updateTransform=function(){var t=this.points;if(!(1>t.length)){var e,i=this.verticies,r=t[0],n={x:0,y:0},s=t[0];this.count-=.2,i[0]=s.x+n.x,i[1]=s.y+n.y,i[2]=s.x-n.x,i[3]=s.y-n.y;for(var a=t.length,h=1;a>h;h++){var s=t[h],l=4*h;e=t.length-1>h?t[h+1]:s,n.y=-(e.x-r.x),n.x=e.y-r.y;var u=10*(1-h/(a-1));u>1&&(u=1);var c=Math.sqrt(n.x*n.x+n.y*n.y),d=this.texture.height/2;n.x/=c,n.y/=c,n.x*=d,n.y*=d,i[l]=s.x+n.x,i[l+1]=s.y+n.y,i[l+2]=s.x-n.x,i[l+3]=s.y-n.y,r=s}o.DisplayObjectContainer.prototype.updateTransform.call(this)}},o.Rope.prototype.setTexture=function(t){this.texture=t,this.updateFrame=!0},o.TilingSprite=function(t,e,i){o.DisplayObjectContainer.call(this),this.texture=t,this.width=e,this.height=i,this.renderable=!0,this.tileScale=new o.Point(1,1),this.tilePosition=new o.Point(0,0),this.blendMode=o.blendModes.NORMAL},o.TilingSprite.constructor=o.TilingSprite,o.TilingSprite.prototype=Object.create(o.DisplayObjectContainer.prototype),o.TilingSprite.prototype.setTexture=function(t){this.texture=t,this.updateFrame=!0},o.TilingSprite.prototype.onTextureUpdate=function(){this.updateFrame=!0},o.Spine=function(t){if(o.DisplayObjectContainer.call(this),this.spineData=o.AnimCache[t],!this.spineData)throw Error("Spine data must be preloaded using PIXI.SpineLoader or PIXI.AssetLoader: "+t);this.count=0,this.sprites=[],this.skeleton=new d.Skeleton(this.spineData),this.skeleton.updateWorldTransform(),this.stateData=new d.AnimationStateData(this.spineData),this.state=new d.AnimationState(this.stateData);for(var e=0;this.skeleton.drawOrder.length>e;e++){var i=this.skeleton.drawOrder[e].data.attachmentName;o.TextureCache[i]||(i+=".png");var r=new o.Sprite(o.Texture.fromFrame(i));r.anchor.x=r.anchor.y=.5,this.addChild(r),this.sprites.push(r)}},o.Spine.constructor=o.Spine,o.Spine.prototype=Object.create(o.DisplayObjectContainer.prototype),o.Spine.prototype.updateTransform=function(){this.state.update(1/60),this.state.apply(this.skeleton),this.skeleton.updateWorldTransform();for(var t=0;this.skeleton.drawOrder.length>t;t++){var e=this.skeleton.drawOrder[t],i=e.bone.worldX+e.attachment.x*e.bone.m00+e.attachment.y*e.bone.m01+.5*e.attachment.width,r=e.bone.worldY+e.attachment.x*e.bone.m10+e.attachment.y*e.bone.m11+.5*e.attachment.height;if(e.cacheName!=e.attachment.name){var n=e.attachment.name;o.TextureCache[n]||(n+=".png"),this.sprites[t].setTexture(o.TextureCache[n]),e.cacheName=e.attachment.name}i+=-(e.attachment.width*(e.bone.worldScaleX+e.attachment.scaleX-1)>>1),r+=-(e.attachment.height*(e.bone.worldScaleY+e.attachment.scaleY-1)>>1),this.sprites[t].position.x=i,this.sprites[t].position.y=r,this.sprites[t].rotation=-(e.bone.worldRotation+e.attachment.rotation)*(Math.PI/180)}o.DisplayObjectContainer.prototype.updateTransform.call(this)};var d={};d.BoneData=function(t,e){this.name=t,this.parent=e},d.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1},d.SlotData=function(t,e){this.name=t,this.boneData=e},d.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null},d.Bone=function(t,e){this.data=t,this.parent=e,this.setToSetupPose()},d.Bone.yDown=!1,d.Bone.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,m00:0,m01:0,worldX:0,m10:0,m11:0,worldY:0,worldRotation:0,worldScaleX:1,worldScaleY:1,updateWorldTransform:function(t,e){var i=this.parent;null!=i?(this.worldX=this.x*i.m00+this.y*i.m01+i.worldX,this.worldY=this.x*i.m10+this.y*i.m11+i.worldY,this.worldScaleX=i.worldScaleX*this.scaleX,this.worldScaleY=i.worldScaleY*this.scaleY,this.worldRotation=i.worldRotation+this.rotation):(this.worldX=this.x,this.worldY=this.y,this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY,this.worldRotation=this.rotation);var r=this.worldRotation*Math.PI/180,n=Math.cos(r),s=Math.sin(r);this.m00=n*this.worldScaleX,this.m10=s*this.worldScaleX,this.m01=-s*this.worldScaleY,this.m11=n*this.worldScaleY,t&&(this.m00=-this.m00,this.m01=-this.m01),e&&(this.m10=-this.m10,this.m11=-this.m11),d.Bone.yDown&&(this.m10=-this.m10,this.m11=-this.m11)},setToSetupPose:function(){var t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY}},d.Slot=function(t,e,i){this.data=t,this.skeleton=e,this.bone=i,this.setToSetupPose()},d.Slot.prototype={r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,setAttachment:function(t){this.attachment=t,this._attachmentTime=this.skeleton.time},setAttachmentTime:function(t){this._attachmentTime=this.skeleton.time-t},getAttachmentTime:function(){return this.skeleton.time-this._attachmentTime},setToSetupPose:function(){var t=this.data;this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a;for(var e=this.skeleton.data.slots,i=0,r=e.length;r>i;i++)if(e[i]==t){this.setAttachment(t.attachmentName?this.skeleton.getAttachmentBySlotIndex(i,t.attachmentName):null);
break}}},d.Skin=function(t){this.name=t,this.attachments={}},d.Skin.prototype={addAttachment:function(t,e,i){this.attachments[t+":"+e]=i},getAttachment:function(t,e){return this.attachments[t+":"+e]},_attachAll:function(t,e){for(var i in e.attachments){var r=i.indexOf(":"),n=parseInt(i.substring(0,r)),s=i.substring(r+1),a=t.slots[n];if(a.attachment&&a.attachment.name==s){var o=this.getAttachment(n,s);o&&a.setAttachment(o)}}}},d.Animation=function(t,e,i){this.name=t,this.timelines=e,this.duration=i},d.Animation.prototype={apply:function(t,e,i){i&&0!=this.duration&&(e%=this.duration);for(var r=this.timelines,n=0,s=r.length;s>n;n++)r[n].apply(t,e,1)},mix:function(t,e,i,r){i&&0!=this.duration&&(e%=this.duration);for(var n=this.timelines,s=0,a=n.length;a>s;s++)n[s].apply(t,e,r)}},d.binarySearch=function(t,e,i){var r=0,n=Math.floor(t.length/i)-2;if(0==n)return i;for(var s=n>>>1;;){if(e>=t[(s+1)*i]?r=s+1:n=s,r==n)return(r+1)*i;s=r+n>>>1}},d.linearSearch=function(t,e,i){for(var r=0,n=t.length-i;n>=r;r+=i)if(t[r]>e)return r;return-1},d.Curves=function(t){this.curves=[],this.curves.length=6*(t-1)},d.Curves.prototype={setLinear:function(t){this.curves[6*t]=0},setStepped:function(t){this.curves[6*t]=-1},setCurve:function(t,e,i,r,n){var s=.1,a=s*s,o=a*s,h=3*s,l=3*a,u=6*a,c=6*o,d=2*-e+r,p=2*-i+n,f=3*(e-r)+1,v=3*(i-n)+1,m=6*t,g=this.curves;g[m]=e*h+d*l+f*o,g[m+1]=i*h+p*l+v*o,g[m+2]=d*u+f*c,g[m+3]=p*u+v*c,g[m+4]=f*c,g[m+5]=v*c},getCurvePercent:function(t,e){e=0>e?0:e>1?1:e;var i=6*t,r=this.curves,n=r[i];if(!n)return e;if(-1==n)return 0;for(var s=r[i+1],a=r[i+2],o=r[i+3],h=r[i+4],l=r[i+5],u=n,c=s,d=8;;){if(u>=e){var p=u-n,f=c-s;return f+(c-f)*(e-p)/(u-p)}if(0==d)break;d--,n+=a,s+=o,a+=h,o+=l,u+=n,c+=s}return c+(1-c)*(e-u)/(1-u)}},d.RotateTimeline=function(t){this.curves=new d.Curves(t),this.frames=[],this.frames.length=2*t},d.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(t,e,i){t*=2,this.frames[t]=e,this.frames[t+1]=i},apply:function(t,e,i){var r=this.frames;if(!(r[0]>e)){var n=t.bones[this.boneIndex];if(e>=r[r.length-2]){for(var s=n.data.rotation+r[r.length-1]-n.rotation;s>180;)s-=360;for(;-180>s;)s+=360;return n.rotation+=s*i,void 0}var a=d.binarySearch(r,e,2),o=r[a-1],h=r[a],l=1-(e-h)/(r[a-2]-h);l=this.curves.getCurvePercent(a/2-1,l);for(var s=r[a+1]-o;s>180;)s-=360;for(;-180>s;)s+=360;for(s=n.data.rotation+(o+s*l)-n.rotation;s>180;)s-=360;for(;-180>s;)s+=360;n.rotation+=s*i}}},d.TranslateTimeline=function(t){this.curves=new d.Curves(t),this.frames=[],this.frames.length=3*t},d.TranslateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(t,e,i,r){t*=3,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=r},apply:function(t,e,i){var r=this.frames;if(!(r[0]>e)){var n=t.bones[this.boneIndex];if(e>=r[r.length-3])return n.x+=(n.data.x+r[r.length-2]-n.x)*i,n.y+=(n.data.y+r[r.length-1]-n.y)*i,void 0;var s=d.binarySearch(r,e,3),a=r[s-2],o=r[s-1],h=r[s],l=1-(e-h)/(r[s+-3]-h);l=this.curves.getCurvePercent(s/3-1,l),n.x+=(n.data.x+a+(r[s+1]-a)*l-n.x)*i,n.y+=(n.data.y+o+(r[s+2]-o)*l-n.y)*i}}},d.ScaleTimeline=function(t){this.curves=new d.Curves(t),this.frames=[],this.frames.length=3*t},d.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(t,e,i,r){t*=3,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=r},apply:function(t,e,i){var r=this.frames;if(!(r[0]>e)){var n=t.bones[this.boneIndex];if(e>=r[r.length-3])return n.scaleX+=(n.data.scaleX-1+r[r.length-2]-n.scaleX)*i,n.scaleY+=(n.data.scaleY-1+r[r.length-1]-n.scaleY)*i,void 0;var s=d.binarySearch(r,e,3),a=r[s-2],o=r[s-1],h=r[s],l=1-(e-h)/(r[s+-3]-h);l=this.curves.getCurvePercent(s/3-1,l),n.scaleX+=(n.data.scaleX-1+a+(r[s+1]-a)*l-n.scaleX)*i,n.scaleY+=(n.data.scaleY-1+o+(r[s+2]-o)*l-n.scaleY)*i}}},d.ColorTimeline=function(t){this.curves=new d.Curves(t),this.frames=[],this.frames.length=5*t},d.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(t,e){t*=5,this.frames[t]=e,this.frames[t+1]=r,this.frames[t+2]=g,this.frames[t+3]=b,this.frames[t+4]=a},apply:function(t,e,i){var r=this.frames;if(!(r[0]>e)){var n=t.slots[this.slotIndex];if(e>=r[r.length-5]){var s=r.length-1;return n.r=r[s-3],n.g=r[s-2],n.b=r[s-1],n.a=r[s],void 0}var a=d.binarySearch(r,e,5),o=r[a-4],h=r[a-3],l=r[a-2],u=r[a-1],c=r[a],p=1-(e-c)/(r[a-5]-c);p=this.curves.getCurvePercent(a/5-1,p);var f=o+(r[a+1]-o)*p,v=h+(r[a+2]-h)*p,m=l+(r[a+3]-l)*p,g=u+(r[a+4]-u)*p;1>i?(n.r+=(f-n.r)*i,n.g+=(v-n.g)*i,n.b+=(m-n.b)*i,n.a+=(g-n.a)*i):(n.r=f,n.g=v,n.b=m,n.a=g)}}},d.AttachmentTimeline=function(t){this.curves=new d.Curves(t),this.frames=[],this.frames.length=t,this.attachmentNames=[],this.attachmentNames.length=t},d.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(t,e,i){this.frames[t]=e,this.attachmentNames[t]=i},apply:function(t,e){var i=this.frames;if(!(i[0]>e)){var r;r=e>=i[i.length-1]?i.length-1:d.binarySearch(i,e,1)-1;var n=this.attachmentNames[r];t.slots[this.slotIndex].setAttachment(n?t.getAttachmentBySlotIndex(this.slotIndex,n):null)}}},d.SkeletonData=function(){this.bones=[],this.slots=[],this.skins=[],this.animations=[]},d.SkeletonData.prototype={defaultSkin:null,findBone:function(t){for(var e=this.bones,i=0,r=e.length;r>i;i++)if(e[i].name==t)return e[i];return null},findBoneIndex:function(t){for(var e=this.bones,i=0,r=e.length;r>i;i++)if(e[i].name==t)return i;return-1},findSlot:function(t){for(var e=this.slots,i=0,r=e.length;r>i;i++)if(e[i].name==t)return slot[i];return null},findSlotIndex:function(t){for(var e=this.slots,i=0,r=e.length;r>i;i++)if(e[i].name==t)return i;return-1},findSkin:function(t){for(var e=this.skins,i=0,r=e.length;r>i;i++)if(e[i].name==t)return e[i];return null},findAnimation:function(t){for(var e=this.animations,i=0,r=e.length;r>i;i++)if(e[i].name==t)return e[i];return null}},d.Skeleton=function(t){this.data=t,this.bones=[];for(var e=0,i=t.bones.length;i>e;e++){var r=t.bones[e],n=r.parent?this.bones[t.bones.indexOf(r.parent)]:null;this.bones.push(new d.Bone(r,n))}this.slots=[],this.drawOrder=[];for(var e=0,i=t.slots.length;i>e;e++){var s=t.slots[e],a=this.bones[t.bones.indexOf(s.boneData)],o=new d.Slot(s,this,a);this.slots.push(o),this.drawOrder.push(o)}},d.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:!1,flipY:!1,updateWorldTransform:function(){for(var t=this.flipX,e=this.flipY,i=this.bones,r=0,n=i.length;n>r;r++)i[r].updateWorldTransform(t,e)},setToSetupPose:function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},setBonesToSetupPose:function(){for(var t=this.bones,e=0,i=t.length;i>e;e++)t[e].setToSetupPose()},setSlotsToSetupPose:function(){for(var t=this.slots,e=0,i=t.length;i>e;e++)t[e].setToSetupPose(e)},getRootBone:function(){return 0==this.bones.length?null:this.bones[0]},findBone:function(t){for(var e=this.bones,i=0,r=e.length;r>i;i++)if(e[i].data.name==t)return e[i];return null},findBoneIndex:function(t){for(var e=this.bones,i=0,r=e.length;r>i;i++)if(e[i].data.name==t)return i;return-1},findSlot:function(t){for(var e=this.slots,i=0,r=e.length;r>i;i++)if(e[i].data.name==t)return e[i];return null},findSlotIndex:function(t){for(var e=this.slots,i=0,r=e.length;r>i;i++)if(e[i].data.name==t)return i;return-1},setSkinByName:function(t){var e=this.data.findSkin(t);if(!e)throw"Skin not found: "+t;this.setSkin(e)},setSkin:function(t){this.skin&&t&&t._attachAll(this,this.skin),this.skin=t},getAttachmentBySlotName:function(t,e){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(t),e)},getAttachmentBySlotIndex:function(t,e){if(this.skin){var i=this.skin.getAttachment(t,e);if(i)return i}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null},setAttachment:function(t,e){for(var i=this.slots,r=0,n=i.size;n>r;r++){var s=i[r];if(s.data.name==t){var a=null;if(e&&(a=this.getAttachment(r,e),null==a))throw"Attachment not found: "+e+", for slot: "+t;return s.setAttachment(a),void 0}}throw"Slot not found: "+t},update:function(t){time+=t}},d.AttachmentType={region:0},d.RegionAttachment=function(){this.offset=[],this.offset.length=8,this.uvs=[],this.uvs.length=8},d.RegionAttachment.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(t,e,i,r,n){var s=this.uvs;n?(s[2]=t,s[3]=r,s[4]=t,s[5]=e,s[6]=i,s[7]=e,s[0]=i,s[1]=r):(s[0]=t,s[1]=r,s[2]=t,s[3]=e,s[4]=i,s[5]=e,s[6]=i,s[7]=r)},updateOffset:function(){var t=this.width/this.regionOriginalWidth*this.scaleX,e=this.height/this.regionOriginalHeight*this.scaleY,i=-this.width/2*this.scaleX+this.regionOffsetX*t,r=-this.height/2*this.scaleY+this.regionOffsetY*e,n=i+this.regionWidth*t,s=r+this.regionHeight*e,a=this.rotation*Math.PI/180,o=Math.cos(a),h=Math.sin(a),l=i*o+this.x,u=i*h,c=r*o+this.y,d=r*h,p=n*o+this.x,f=n*h,v=s*o+this.y,m=s*h,g=this.offset;g[0]=l-d,g[1]=c+u,g[2]=l-m,g[3]=v+u,g[4]=p-m,g[5]=v+f,g[6]=p-d,g[7]=c+f},computeVertices:function(t,e,i,r){t+=i.worldX,e+=i.worldY;var n=i.m00,s=i.m01,a=i.m10,o=i.m11,h=this.offset;r[0]=h[0]*n+h[1]*s+t,r[1]=h[0]*a+h[1]*o+e,r[2]=h[2]*n+h[3]*s+t,r[3]=h[2]*a+h[3]*o+e,r[4]=h[4]*n+h[5]*s+t,r[5]=h[4]*a+h[5]*o+e,r[6]=h[6]*n+h[7]*s+t,r[7]=h[6]*a+h[7]*o+e}},d.AnimationStateData=function(t){this.skeletonData=t,this.animationToMixTime={}},d.AnimationStateData.prototype={setMixByName:function(t,e,i){var r=this.skeletonData.findAnimation(t);if(!r)throw"Animation not found: "+t;var n=this.skeletonData.findAnimation(e);if(!n)throw"Animation not found: "+e;this.setMix(r,n,i)},setMix:function(t,e,i){this.animationToMixTime[t.name+":"+e.name]=i},getMix:function(t,e){var i=this.animationToMixTime[t.name+":"+e.name];return i?i:0}},d.AnimationState=function(t){this.data=t,this.queue=[]},d.AnimationState.prototype={current:null,previous:null,currentTime:0,previousTime:0,currentLoop:!1,previousLoop:!1,mixTime:0,mixDuration:0,update:function(t){if(this.currentTime+=t,this.previousTime+=t,this.mixTime+=t,this.queue.length>0){var e=this.queue[0];this.currentTime>=e.delay&&(this._setAnimation(e.animation,e.loop),this.queue.shift())}},apply:function(t){if(this.current)if(this.previous){this.previous.apply(t,this.previousTime,this.previousLoop);var e=this.mixTime/this.mixDuration;e>=1&&(e=1,this.previous=null),this.current.mix(t,this.currentTime,this.currentLoop,e)}else this.current.apply(t,this.currentTime,this.currentLoop)},clearAnimation:function(){this.previous=null,this.current=null,this.queue.length=0},_setAnimation:function(t,e){this.previous=null,t&&this.current&&(this.mixDuration=this.data.getMix(this.current,t),this.mixDuration>0&&(this.mixTime=0,this.previous=this.current,this.previousTime=this.currentTime,this.previousLoop=this.currentLoop)),this.current=t,this.currentLoop=e,this.currentTime=0},setAnimationByName:function(t,e){var i=this.data.skeletonData.findAnimation(t);if(!i)throw"Animation not found: "+t;this.setAnimation(i,e)},setAnimation:function(t,e){this.queue.length=0,this._setAnimation(t,e)},addAnimationByName:function(t,e,i){var r=this.data.skeletonData.findAnimation(t);if(!r)throw"Animation not found: "+t;this.addAnimation(r,e,i)},addAnimation:function(t,e,i){var r={};if(r.animation=t,r.loop=e,!i||0>=i){var n=0==this.queue.length?this.current:this.queue[this.queue.length-1].animation;i=null!=n?n.duration-this.data.getMix(n,t)+(i||0):0}r.delay=i,this.queue.push(r)},isComplete:function(){return!this.current||this.currentTime>=this.current.duration}},d.SkeletonJson=function(t){this.attachmentLoader=t},d.SkeletonJson.prototype={scale:1,readSkeletonData:function(t){for(var e=new d.SkeletonData,i=t.bones,r=0,n=i.length;n>r;r++){var s=i[r],a=null;if(s.parent&&(a=e.findBone(s.parent),!a))throw"Parent bone not found: "+s.parent;var o=new d.BoneData(s.name,a);o.length=(s.length||0)*this.scale,o.x=(s.x||0)*this.scale,o.y=(s.y||0)*this.scale,o.rotation=s.rotation||0,o.scaleX=s.scaleX||1,o.scaleY=s.scaleY||1,e.bones.push(o)}for(var h=t.slots,r=0,n=h.length;n>r;r++){var l=h[r],o=e.findBone(l.bone);if(!o)throw"Slot bone not found: "+l.bone;var u=new d.SlotData(l.name,o),c=l.color;c&&(u.r=d.SkeletonJson.toColor(c,0),u.g=d.SkeletonJson.toColor(c,1),u.b=d.SkeletonJson.toColor(c,2),u.a=d.SkeletonJson.toColor(c,3)),u.attachmentName=l.attachment,e.slots.push(u)}var p=t.skins;for(var f in p)if(p.hasOwnProperty(f)){var v=p[f],m=new d.Skin(f);for(var g in v)if(v.hasOwnProperty(g)){var x=e.findSlotIndex(g),b=v[g];for(var y in b)if(b.hasOwnProperty(y)){var T=this.readAttachment(m,y,b[y]);null!=T&&m.addAttachment(x,y,T)}}e.skins.push(m),"default"==m.name&&(e.defaultSkin=m)}var w=t.animations;for(var _ in w)w.hasOwnProperty(_)&&this.readAnimation(_,w[_],e);return e},readAttachment:function(t,e,i){e=i.name||e;var r=d.AttachmentType[i.type||"region"],n=new d.RegionAttachment;return n.name=e,r==d.AttachmentType.region&&(n.x=(i.x||0)*this.scale,n.y=(i.y||0)*this.scale,n.scaleX=i.scaleX||1,n.scaleY=i.scaleY||1,n.rotation=i.rotation||0,n.width=(i.width||32)*this.scale,n.height=(i.height||32)*this.scale,n.updateOffset()),n},readAnimation:function(t,e,i){var r=[],n=0,s=e.bones;for(var a in s)if(s.hasOwnProperty(a)){var o=i.findBoneIndex(a);if(-1==o)throw"Bone not found: "+a;var h=s[a];for(var l in h)if(h.hasOwnProperty(l)){var u=h[l];if("rotate"==l){var c=new d.RotateTimeline(u.length);c.boneIndex=o;for(var p=0,f=0,v=u.length;v>f;f++){var m=u[f];c.setFrame(p,m.time,m.angle),d.SkeletonJson.readCurve(c,p,m),p++}r.push(c),n=Math.max(n,c.frames[2*c.getFrameCount()-2])}else{if("translate"!=l&&"scale"!=l)throw"Invalid timeline type for a bone: "+l+" ("+a+")";var c,g=1;"scale"==l?c=new d.ScaleTimeline(u.length):(c=new d.TranslateTimeline(u.length),g=this.scale),c.boneIndex=o;for(var p=0,f=0,v=u.length;v>f;f++){var m=u[f],x=(m.x||0)*g,b=(m.y||0)*g;c.setFrame(p,m.time,x,b),d.SkeletonJson.readCurve(c,p,m),p++}r.push(c),n=Math.max(n,c.frames[3*c.getFrameCount()-3])}}}var y=e.slots;for(var T in y)if(y.hasOwnProperty(T)){var w=y[T],_=i.findSlotIndex(T);for(var l in w)if(w.hasOwnProperty(l)){var u=w[l];if("color"==l){var c=new d.ColorTimeline(u.length);c.slotIndex=_;for(var p=0,f=0,v=u.length;v>f;f++){var m=u[f],A=m.color,R=d.SkeletonJson.toColor(A,0),S=d.SkeletonJson.toColor(A,1),L=d.SkeletonJson.toColor(A,2),C=d.SkeletonJson.toColor(A,3);c.setFrame(p,m.time,R,S,L,C),d.SkeletonJson.readCurve(c,p,m),p++}r.push(c),n=Math.max(n,c.frames[5*c.getFrameCount()-5])}else{if("attachment"!=l)throw"Invalid timeline type for a slot: "+l+" ("+T+")";var c=new d.AttachmentTimeline(u.length);c.slotIndex=_;for(var p=0,f=0,v=u.length;v>f;f++){var m=u[f];c.setFrame(p++,m.time,m.name)}r.push(c),n=Math.max(n,c.frames[Math.floor(c.getFrameCount())-1])}}}i.animations.push(new d.Animation(t,r,n))}},d.SkeletonJson.readCurve=function(t,e,i){var r=i.curve;r&&("stepped"==r?t.curves.setStepped(e):r instanceof Array&&t.curves.setCurve(e,r[0],r[1],r[2],r[3]))},d.SkeletonJson.toColor=function(t,e){if(8!=t.length)throw"Color hexidecimal length must be 8, recieved: "+t;return parseInt(t.substring(2*e,2),16)/255},d.Atlas=function(t,e){this.textureLoader=e,this.pages=[],this.regions=[];var i=new d.AtlasReader(t),r=[];r.length=4;for(var n=null;;){var s=i.readLine();if(null==s)break;if(s=i.trim(s),0==s.length)n=null;else if(n){var a=new d.AtlasRegion;a.name=s,a.page=n,a.rotate="true"==i.readValue(),i.readTuple(r);var o=parseInt(r[0]),h=parseInt(r[1]);i.readTuple(r);var l=parseInt(r[0]),u=parseInt(r[1]);a.u=o/n.width,a.v=h/n.height,a.rotate?(a.u2=(o+u)/n.width,a.v2=(h+l)/n.height):(a.u2=(o+l)/n.width,a.v2=(h+u)/n.height),a.x=o,a.y=h,a.width=Math.abs(l),a.height=Math.abs(u),4==i.readTuple(r)&&(a.splits=[parseInt(r[0]),parseInt(r[1]),parseInt(r[2]),parseInt(r[3])],4==i.readTuple(r)&&(a.pads=[parseInt(r[0]),parseInt(r[1]),parseInt(r[2]),parseInt(r[3])],i.readTuple(r))),a.originalWidth=parseInt(r[0]),a.originalHeight=parseInt(r[1]),i.readTuple(r),a.offsetX=parseInt(r[0]),a.offsetY=parseInt(r[1]),a.index=parseInt(i.readValue()),this.regions.push(a)}else{n=new d.AtlasPage,n.name=s,n.format=d.Atlas.Format[i.readValue()],i.readTuple(r),n.minFilter=d.Atlas.TextureFilter[r[0]],n.magFilter=d.Atlas.TextureFilter[r[1]];var c=i.readValue();n.uWrap=d.Atlas.TextureWrap.clampToEdge,n.vWrap=d.Atlas.TextureWrap.clampToEdge,"x"==c?n.uWrap=d.Atlas.TextureWrap.repeat:"y"==c?n.vWrap=d.Atlas.TextureWrap.repeat:"xy"==c&&(n.uWrap=n.vWrap=d.Atlas.TextureWrap.repeat),e.load(n,s),this.pages.push(n)}}},d.Atlas.prototype={findRegion:function(t){for(var e=this.regions,i=0,r=e.length;r>i;i++)if(e[i].name==t)return e[i];return null},dispose:function(){for(var t=this.pages,e=0,i=t.length;i>e;e++)this.textureLoader.unload(t[e].rendererObject)},updateUVs:function(t){for(var e=this.regions,i=0,r=e.length;r>i;i++){var n=e[i];n.page==t&&(n.u=n.x/t.width,n.v=n.y/t.height,n.rotate?(n.u2=(n.x+n.height)/t.width,n.v2=(n.y+n.width)/t.height):(n.u2=(n.x+n.width)/t.width,n.v2=(n.y+n.height)/t.height))}}},d.Atlas.Format={alpha:0,intensity:1,luminanceAlpha:2,rgb565:3,rgba4444:4,rgb888:5,rgba8888:6},d.Atlas.TextureFilter={nearest:0,linear:1,mipMap:2,mipMapNearestNearest:3,mipMapLinearNearest:4,mipMapNearestLinear:5,mipMapLinearLinear:6},d.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2},d.AtlasPage=function(){},d.AtlasPage.prototype={name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0},d.AtlasRegion=function(){},d.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:!1,splits:null,pads:null},d.AtlasReader=function(t){this.lines=t.split(/\r\n|\r|\n/)},d.AtlasReader.prototype={index:0,trim:function(t){return t.replace(/^\s+|\s+$/g,"")},readLine:function(){return this.index>=this.lines.length?null:this.lines[this.index++]},readValue:function(){var t=this.readLine(),e=t.indexOf(":");if(-1==e)throw"Invalid line: "+t;return this.trim(t.substring(e+1))},readTuple:function(t){var e=this.readLine(),i=e.indexOf(":");if(-1==i)throw"Invalid line: "+e;for(var r=0,n=i+1;3>r;r++){var s=e.indexOf(",",n);if(-1==s){if(0==r)throw"Invalid line: "+e;break}t[r]=this.trim(e.substr(n,s-n)),n=s+1}return t[r]=this.trim(e.substring(n)),r+1}},d.AtlasAttachmentLoader=function(t){this.atlas=t},d.AtlasAttachmentLoader.prototype={newAttachment:function(t,e,i){switch(e){case d.AttachmentType.region:var r=this.atlas.findRegion(i);if(!r)throw"Region not found in atlas: "+i+" ("+e+")";var n=new d.RegionAttachment(i);return n.rendererObject=r,n.setUVs(r.u,r.v,r.u2,r.v2,r.rotate),n.regionOffsetX=r.offsetX,n.regionOffsetY=r.offsetY,n.regionWidth=r.width,n.regionHeight=r.height,n.regionOriginalWidth=r.originalWidth,n.regionOriginalHeight=r.originalHeight,n}throw"Unknown attachment type: "+e}},o.AnimCache={},d.Bone.yDown=!0,o.CustomRenderable=function(){o.DisplayObject.call(this)},o.CustomRenderable.constructor=o.CustomRenderable,o.CustomRenderable.prototype=Object.create(o.DisplayObject.prototype),o.CustomRenderable.prototype.renderCanvas=function(){},o.CustomRenderable.prototype.initWebGL=function(){},o.CustomRenderable.prototype.renderWebGL=function(){},o.BaseTextureCache={},o.texturesToUpdate=[],o.texturesToDestroy=[],o.BaseTexture=function(t){if(o.EventTarget.call(this),this.width=100,this.height=100,this.source=t,t){if(this.source instanceof Image)if(this.source.complete)this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,o.texturesToUpdate.push(this);else{var e=this;this.source.onload=function(){e.hasLoaded=!0,e.width=e.source.width,e.height=e.source.height,o.texturesToUpdate.push(e),e.dispatchEvent({type:"loaded",content:e})}}else this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,o.texturesToUpdate.push(this);this._powerOf2=!1}},o.BaseTexture.constructor=o.BaseTexture,o.BaseTexture.prototype.destroy=function(){this.source instanceof Image&&(this.source.src=null),this.source=null,o.texturesToDestroy.push(this)},o.BaseTexture.fromImage=function(t,e){var i=o.BaseTextureCache[t];if(!i){var r=new Image;e&&(r.crossOrigin=""),r.src=t,i=new o.BaseTexture(r),o.BaseTextureCache[t]=i}return i},o.TextureCache={},o.FrameCache={},o.Texture=function(t,e){if(o.EventTarget.call(this),e||(this.noFrame=!0,e=new o.Rectangle(0,0,1,1)),this.trim=new o.Point,t instanceof o.Texture&&(t=t.baseTexture),this.baseTexture=t,this.frame=e,this.scope=this,t.hasLoaded)this.noFrame&&(e=new o.Rectangle(0,0,t.width,t.height)),this.setFrame(e);else{var i=this;t.addEventListener("loaded",function(){i.onBaseTextureLoaded()})}},o.Texture.constructor=o.Texture,o.Texture.prototype.onBaseTextureLoaded=function(){var t=this.baseTexture;t.removeEventListener("loaded",this.onLoaded),this.noFrame&&(this.frame=new o.Rectangle(0,0,t.width,t.height)),this.noFrame=!1,this.width=this.frame.width,this.height=this.frame.height,this.scope.dispatchEvent({type:"update",content:this})},o.Texture.prototype.destroy=function(t){t&&this.baseTexture.destroy()},o.Texture.prototype.setFrame=function(t){if(this.frame=t,this.width=t.width,this.height=t.height,t.x+t.width>this.baseTexture.width||t.y+t.height>this.baseTexture.height)throw Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.updateFrame=!0,o.Texture.frameUpdates.push(this)},o.Texture.fromImage=function(t,e){var i=o.TextureCache[t];return i||(i=new o.Texture(o.BaseTexture.fromImage(t,e)),o.TextureCache[t]=i),i},o.Texture.fromFrame=function(t){var e=o.TextureCache[t];if(!e)throw Error("The frameId '"+t+"' does not exist in the texture cache "+this);return e},o.Texture.fromCanvas=function(t){var e=new o.BaseTexture(t);return new o.Texture(e)},o.Texture.addTextureToCache=function(t,e){o.TextureCache[e]=t},o.Texture.removeTextureFromCache=function(t){var e=o.TextureCache[t];return o.TextureCache[t]=null,e},o.Texture.frameUpdates=[],o.RenderTexture=function(t,e){o.EventTarget.call(this),this.width=t||100,this.height=e||100,this.indetityMatrix=o.mat3.create(),this.frame=new o.Rectangle(0,0,this.width,this.height),o.gl?this.initWebGL():this.initCanvas()},o.RenderTexture.constructor=o.RenderTexture,o.RenderTexture.prototype=Object.create(o.Texture.prototype),o.RenderTexture.prototype.initWebGL=function(){var t=o.gl;this.glFramebuffer=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this.glFramebuffer),this.glFramebuffer.width=this.width,this.glFramebuffer.height=this.height,this.baseTexture=new o.BaseTexture,this.baseTexture.width=this.width,this.baseTexture.height=this.height,this.baseTexture._glTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.baseTexture._glTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),this.baseTexture.isRender=!0,t.bindFramebuffer(t.FRAMEBUFFER,this.glFramebuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.baseTexture._glTexture,0),this.projectionMatrix=o.mat4.create(),this.projectionMatrix[5]=2/this.height,this.projectionMatrix[13]=-1,this.projectionMatrix[0]=2/this.width,this.projectionMatrix[12]=-1,this.render=this.renderWebGL},o.RenderTexture.prototype.initCanvas=function(){this.renderer=new o.CanvasRenderer(this.width,this.height,null,0),this.baseTexture=new o.BaseTexture(this.renderer.view),this.frame=new o.Rectangle(0,0,this.width,this.height),this.render=this.renderCanvas},o.RenderTexture.prototype.renderWebGL=function(t,e){var i=o.gl;i.colorMask(!0,!0,!0,!0),i.viewport(0,0,this.width,this.height),i.bindFramebuffer(i.FRAMEBUFFER,this.glFramebuffer),e&&(i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT));var r=t.children;t.worldTransform=o.mat3.create();for(var n=0,s=r.length;s>n;n++)r[n].updateTransform();var a=t.__renderGroup;a?t==a.root?a.render(this.projectionMatrix):a.renderSpecific(t,this.projectionMatrix):(this.renderGroup||(this.renderGroup=new o.WebGLRenderGroup(i)),this.renderGroup.setRenderable(t),this.renderGroup.render(this.projectionMatrix))},o.RenderTexture.prototype.renderCanvas=function(t,e){var i=t.children;t.worldTransform=o.mat3.create();for(var r=0,n=i.length;n>r;r++)i[r].updateTransform();e&&this.renderer.context.clearRect(0,0,this.width,this.height),this.renderer.renderDisplayObject(t),o.texturesToUpdate.push(this.baseTexture)},o.AssetLoader=function(t){o.EventTarget.call(this),this.assetURLs=t,this.crossorigin=!1,this.loadersByType={jpg:o.ImageLoader,jpeg:o.ImageLoader,png:o.ImageLoader,gif:o.ImageLoader,json:o.JsonLoader,anim:o.SpineLoader,xml:o.BitmapFontLoader,fnt:o.BitmapFontLoader}},o.AssetLoader.constructor=o.AssetLoader,o.AssetLoader.prototype.load=function(){var t=this;this.loadCount=this.assetURLs.length;for(var e=0;this.assetURLs.length>e;e++){var i=this.assetURLs[e],r=i.split(".").pop().toLowerCase(),n=this.loadersByType[r];if(!n)throw Error(r+" is an unsupported file type");var s=new n(i,this.crossorigin);s.addEventListener("loaded",function(){t.onAssetLoaded()}),s.load()}},o.AssetLoader.prototype.onAssetLoaded=function(){this.loadCount--,this.dispatchEvent({type:"onProgress",content:this}),this.onProgress&&this.onProgress(),0==this.loadCount&&(this.dispatchEvent({type:"onComplete",content:this}),this.onComplete&&this.onComplete())},o.JsonLoader=function(t,e){o.EventTarget.call(this),this.url=t,this.baseUrl=t.replace(/[^\/]*$/,""),this.crossorigin=e,this.loaded=!1},o.JsonLoader.constructor=o.JsonLoader,o.JsonLoader.prototype.load=function(){this.ajaxRequest=new c;var t=this;this.ajaxRequest.onreadystatechange=function(){t.onJSONLoaded()},this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/json"),this.ajaxRequest.send(null)},o.JsonLoader.prototype.onJSONLoaded=function(){if(4==this.ajaxRequest.readyState)if(200==this.ajaxRequest.status||-1==window.location.href.indexOf("http"))if(this.json=JSON.parse(this.ajaxRequest.responseText),this.json.frames){var t=this,e=this.baseUrl+this.json.meta.image,i=new o.ImageLoader(e,this.crossorigin),r=this.json.frames;this.texture=i.texture.baseTexture,i.addEventListener("loaded",function(){t.onLoaded()});for(var n in r){var s=r[n].frame;s&&(o.TextureCache[n]=new o.Texture(this.texture,{x:s.x,y:s.y,width:s.w,height:s.h}),r[n].trimmed&&(o.TextureCache[n].realSize=r[n].spriteSourceSize,o.TextureCache[n].trim.x=0))}i.load()}else if(this.json.bones){var a=new d.SkeletonJson,h=a.readSkeletonData(this.json);o.AnimCache[this.url]=h,this.onLoaded()}else this.onLoaded();else this.onError()},o.JsonLoader.prototype.onLoaded=function(){this.loaded=!0,this.dispatchEvent({type:"loaded",content:this})},o.JsonLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})},o.SpriteSheetLoader=function(t,e){o.EventTarget.call(this),this.url=t,this.baseUrl=t.replace(/[^\/]*$/,""),this.texture=null,this.frames={},this.crossorigin=e},o.SpriteSheetLoader.constructor=o.SpriteSheetLoader,o.SpriteSheetLoader.prototype.load=function(){var t=this,e=new o.JsonLoader(this.url,this.crossorigin);e.addEventListener("loaded",function(e){t.json=e.content.json,t.onJSONLoaded()}),e.load()},o.SpriteSheetLoader.prototype.onJSONLoaded=function(){var t=this,e=this.baseUrl+this.json.meta.image,i=new o.ImageLoader(e,this.crossorigin),r=this.json.frames;this.texture=i.texture.baseTexture,i.addEventListener("loaded",function(){t.onLoaded()});for(var n in r){var s=r[n].frame;s&&(o.TextureCache[n]=new o.Texture(this.texture,{x:s.x,y:s.y,width:s.w,height:s.h}),r[n].trimmed&&(o.TextureCache[n].realSize=r[n].spriteSourceSize,o.TextureCache[n].trim.x=0))}i.load()},o.SpriteSheetLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},o.ImageLoader=function(t,e){o.EventTarget.call(this),this.texture=o.Texture.fromImage(t,e)},o.ImageLoader.constructor=o.ImageLoader,o.ImageLoader.prototype.load=function(){if(this.texture.baseTexture.hasLoaded)this.onLoaded();else{var t=this;this.texture.baseTexture.addEventListener("loaded",function(){t.onLoaded()})}},o.ImageLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},o.BitmapFontLoader=function(t,e){o.EventTarget.call(this),this.url=t,this.baseUrl=t.replace(/[^\/]*$/,""),this.texture=null,this.crossorigin=e},o.BitmapFontLoader.constructor=o.BitmapFontLoader,o.BitmapFontLoader.prototype.load=function(){this.ajaxRequest=new XMLHttpRequest;var t=this;this.ajaxRequest.onreadystatechange=function(){t.onXMLLoaded()},this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/xml"),this.ajaxRequest.send(null)},o.BitmapFontLoader.prototype.onXMLLoaded=function(){if(4==this.ajaxRequest.readyState&&(200==this.ajaxRequest.status||-1==window.location.href.indexOf("http"))){var t=this.baseUrl+this.ajaxRequest.responseXML.getElementsByTagName("page")[0].attributes.getNamedItem("file").nodeValue,e=new o.ImageLoader(t,this.crossorigin);this.texture=e.texture.baseTexture;var i={},r=this.ajaxRequest.responseXML.getElementsByTagName("info")[0],n=this.ajaxRequest.responseXML.getElementsByTagName("common")[0];i.font=r.attributes.getNamedItem("face").nodeValue,i.size=parseInt(r.attributes.getNamedItem("size").nodeValue,10),i.lineHeight=parseInt(n.attributes.getNamedItem("lineHeight").nodeValue,10),i.chars={};for(var s=this.ajaxRequest.responseXML.getElementsByTagName("char"),a=0;s.length>a;a++){var h=parseInt(s[a].attributes.getNamedItem("id").nodeValue,10),l={x:parseInt(s[a].attributes.getNamedItem("x").nodeValue,10),y:parseInt(s[a].attributes.getNamedItem("y").nodeValue,10),width:parseInt(s[a].attributes.getNamedItem("width").nodeValue,10),height:parseInt(s[a].attributes.getNamedItem("height").nodeValue,10)};o.TextureCache[h]=new o.Texture(this.texture,l),i.chars[h]={xOffset:parseInt(s[a].attributes.getNamedItem("xoffset").nodeValue,10),yOffset:parseInt(s[a].attributes.getNamedItem("yoffset").nodeValue,10),xAdvance:parseInt(s[a].attributes.getNamedItem("xadvance").nodeValue,10),kerning:{},texture:new o.Texture(this.texture,l)}}var u=this.ajaxRequest.responseXML.getElementsByTagName("kerning");for(a=0;u.length>a;a++){var c=parseInt(u[a].attributes.getNamedItem("first").nodeValue,10),d=parseInt(u[a].attributes.getNamedItem("second").nodeValue,10),p=parseInt(u[a].attributes.getNamedItem("amount").nodeValue,10);i.chars[d].kerning[c]=p}o.BitmapText.fonts[i.font]=i;var f=this;e.addEventListener("loaded",function(){f.onLoaded()}),e.load()}},o.BitmapFontLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},o.SpineLoader=function(t,e){o.EventTarget.call(this),this.url=t,this.crossorigin=e,this.loaded=!1},o.SpineLoader.constructor=o.SpineLoader,o.SpineLoader.prototype.load=function(){new o.JsonLoader(this.url,this.crossorigin),jsonLoader.addEventListener("loaded",function(t){scope.json=t.content.json,scope.onJSONLoaded()}),jsonLoader.load()},o.SpineLoader.prototype.load=function(){var t=this,e=new o.JsonLoader(this.url,this.crossorigin);e.addEventListener("loaded",function(e){t.json=e.content.json,t.onJSONLoaded()}),e.load()},o.SpineLoader.prototype.onJSONLoaded=function(){var t=new d.SkeletonJson,e=t.readSkeletonData(this.json);o.AnimCache[this.url]=e,this.onLoaded()},o.SpineLoader.prototype.onLoaded=function(){this.loaded=!0,this.dispatchEvent({type:"loaded",content:this})},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=o),exports.PIXI=o):s.PIXI=o}).call(this);